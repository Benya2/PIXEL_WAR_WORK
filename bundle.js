const _0x5cbc87=_0x16e4;(function(_0x2fd891,_0x580a52){const _0x424d77=_0x16e4,_0x3033f8=_0x2fd891();while(!![]){try{const _0x4ade28=-parseInt(_0x424d77(0x18a))/0x1+-parseInt(_0x424d77(0x217))/0x2*(parseInt(_0x424d77(0x1ca))/0x3)+-parseInt(_0x424d77(0x18f))/0x4+-parseInt(_0x424d77(0x1ef))/0x5+-parseInt(_0x424d77(0x1c4))/0x6+-parseInt(_0x424d77(0x210))/0x7*(parseInt(_0x424d77(0x1c5))/0x8)+parseInt(_0x424d77(0x1db))/0x9;if(_0x4ade28===_0x580a52)break;else _0x3033f8['push'](_0x3033f8['shift']());}catch(_0x1b0669){_0x3033f8['push'](_0x3033f8['shift']());}}}(_0xc873,0x319ef));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js';import{getFirestore,collection,doc,setDoc,onSnapshot,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js';import{getDatabase,ref,remove}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';import{getAuth,onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js';const firebaseConfig={'apiKey':_0x5cbc87(0x1d5),'authDomain':_0x5cbc87(0x19e),'projectId':_0x5cbc87(0x214),'storageBucket':_0x5cbc87(0x192),'messagingSenderId':_0x5cbc87(0x1fe),'appId':'1:461991610382:web:2a5ae293dde4a754c2d45f'},app=initializeApp(firebaseConfig),db=getFirestore(app),rtdb=getDatabase(app),auth=getAuth(app),coordsDisplayEl=document[_0x5cbc87(0x1fa)]('coordsDisplay'),colorsChoiceEl=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1c7)),paletteToggle=document['getElementById']('paletteToggle'),game=document['getElementById'](_0x5cbc87(0x183)),ctx=game[_0x5cbc87(0x1a8)]('2d'),cursor=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1a6)),reloadTimerEl=document[_0x5cbc87(0x1fa)]('reloadTimer'),adminPanel=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1ac)),clearAllPixelsBtn=document['getElementById']('clearAllPixels'),banUserBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x202)),authButton=document[_0x5cbc87(0x1fa)]('authButton'),coordsInput=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x212)),addPixelBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1e2)),removePixelBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1e6)),teleportInput=document[_0x5cbc87(0x1fa)]('teleportInput'),teleportBtn=document['getElementById']('teleportBtn');teleportBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>{const _0xca160f=_0x5cbc87;if(!auth[_0xca160f(0x185)]||auth[_0xca160f(0x185)]['email']!=='logo100153@gmail.com')return alert('Только\x20админ!');const _0x52ced8=teleportInput['value'][_0xca160f(0x19f)]();if(!_0x52ced8)return;const [_0x1b6e16,_0x4df11b]=_0x52ced8[_0xca160f(0x206)](/\s+/),_0x397e28=parseInt(_0x1b6e16),_0x9fc52f=parseInt(_0x4df11b);if(Number[_0xca160f(0x1c9)](_0x397e28)||Number['isNaN'](_0x9fc52f))return alert(_0xca160f(0x1f9));const _0x44cfa4=_0x397e28*gridCellSize,_0x169b48=_0x9fc52f*gridCellSize;camX=_0x44cfa4-game[_0xca160f(0x1e3)]/0x2/scale,camY=_0x169b48-game[_0xca160f(0x221)]/0x2/scale,renderAll();}),ctx['imageSmoothingEnabled']=![];const gridCellSize=0xa;game[_0x5cbc87(0x1e3)]=0x4b0,game['height']=0x258;let currentColor=_0x5cbc87(0x18e),canPlace=!![];const reloadTime=0x1,colors=['rgb(255,\x20255,\x20255)','rgb(96,\x2064,\x2040)',_0x5cbc87(0x1bb),_0x5cbc87(0x1c6),_0x5cbc87(0x1cf),_0x5cbc87(0x1bf),'rgb(136,\x20136,\x20136)',_0x5cbc87(0x1fc),'rgb(78,\x2078,\x2078)',_0x5cbc87(0x184),_0x5cbc87(0x21a),_0x5cbc87(0x1b0),_0x5cbc87(0x224),'rgb(104,\x20131,\x2056)',_0x5cbc87(0x21d),_0x5cbc87(0x1dc),_0x5cbc87(0x1b6),_0x5cbc87(0x1a0),'rgb(255,\x20101,\x20101)','rgb(0,\x20211,\x20221)',_0x5cbc87(0x19d),_0x5cbc87(0x208),_0x5cbc87(0x194),_0x5cbc87(0x1d3),_0x5cbc87(0x21e),_0x5cbc87(0x1f7),_0x5cbc87(0x1c8),_0x5cbc87(0x18b),_0x5cbc87(0x200),_0x5cbc87(0x1d1)];colorsChoiceEl[_0x5cbc87(0x19b)]='',colors[_0x5cbc87(0x1b1)](_0x5106e9=>{const _0x582084=_0x5cbc87,_0x574f5a=document['createElement']('div');_0x574f5a[_0x582084(0x187)][_0x582084(0x203)]=_0x5106e9,_0x574f5a['addEventListener'](_0x582084(0x1cd),()=>{const _0x14fff4=_0x582084;currentColor=_0x5106e9,document[_0x14fff4(0x1fd)]('#colorsChoice\x20div')[_0x14fff4(0x1b1)](_0x33ad83=>_0x33ad83[_0x14fff4(0x1a2)][_0x14fff4(0x209)](_0x14fff4(0x186))),_0x574f5a[_0x14fff4(0x1a2)][_0x14fff4(0x1f8)](_0x14fff4(0x186));}),colorsChoiceEl['appendChild'](_0x574f5a);});const colorsChoice=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1c7)),togglePalette=document['getElementById'](_0x5cbc87(0x1c2));togglePalette[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>{const _0x404f6d=_0x5cbc87;colorsChoice[_0x404f6d(0x187)][_0x404f6d(0x198)]===_0x404f6d(0x1aa)?colorsChoice[_0x404f6d(0x187)][_0x404f6d(0x198)]=_0x404f6d(0x1ff):colorsChoice[_0x404f6d(0x187)][_0x404f6d(0x198)]=_0x404f6d(0x1aa);});const worldMap=new Image();worldMap['src']=_0x5cbc87(0x21c);const SCALE_TILE=0x64;let WORLD_W=0x4e20*SCALE_TILE,WORLD_H=0x4e20*SCALE_TILE,camX=0x0,camY=0x0,scale=0x1;const MIN_SCALE=0.005,MAX_SCALE=0x6;function _0xc873(){const _0x5e83cd=['rgb(255,\x20167,\x20209)','rgb(254,\x20164,\x2096)','ceil','Только\x20админ!','height','Enter\x201\x20to\x20sign\x20in,\x20or\x202\x20to\x20create\x20a\x20new\x20account:','top\x20left','rgb(244,\x20179,\x20174)','px)\x20scale(','game','rgb(148,\x20224,\x2068)','currentUser','selected','style','clientX','naturalWidth','97045DgMiqW','rgb(207,\x20110,\x20228)','applyCoords','now','#000000','1154132vLEDxK','fillStyle','opacity','pixellox.firebasestorage.app','color','rgb(154,\x200,\x200)','metaKey','coordX','toDataURL','display','overlayTemplate','downBtn','innerHTML','innerText','rgb(229,\x200,\x200)','pixellox.firebaseapp.com','trim','rgb(202,\x20227,\x20255)','push','classList','px,\x20','Email:','mouseup','cursor','Введите\x20UserID\x20для\x20бана:','getContext','shiftKey','none','error','adminPanel','transform','ctrlKey','users/','rgb(2,\x20190,\x201)','forEach','wheel','upBtn','preventDefault','left','rgb(255,\x2084,\x20178)','\x20sec','Online\x20players:\x20','img','stroke','rgb(228,\x20228,\x20228)','val','ref','mousedown','rgb(255,\x20248,\x20137)','files','block','togglePalette','pixels','118260caDAtc','6680SiZUYy','rgb(245,\x20223,\x20176)','colorsChoice','rgb(229,\x20149,\x200)','isNaN','75euUoEJ','zoomOutBtn','readAsDataURL','click','contextmenu','rgb(196,\x20196,\x20196)','clientY','rgb(130,\x200,\x20128)','floor','rgb(0,\x200,\x20234)','Log\x20In','AIzaSyCwy4jVn9JIwXuIXVycYAv9EdPGPkgIJvA','min','zoomInBtn','#eef6ff','setTransform','data','12022866KpDozq','rgb(0,\x20101,\x2019)','email','deltaY','toggleBtn','logo100153@gmail.com','lineTo','addPixelBtn','width','onload','opacityRange','removePixelBtn','src','moveTo','result','message','fillRect','coordY','then','Reload:\x20','1582545hGOTEO','getBoundingClientRect','change','strokeStyle','Account\x20created!','input','target','#FFFFFF','rgb(25,\x2025,\x20115)','add','Введите\x20корректные\x20координаты\x20X\x20Y','getElementById','naturalHeight','rgb(229,\x20217,\x200)','querySelectorAll','461991610382','grid','rgb(160,\x20106,\x2066)','textContent','banUser','backgroundColor','imageSmoothingEnabled','beginPath','split','drawImage','rgb(0,\x20131,\x20199)','remove','length','Ready!','\x20\x20Y:\x20','addEventListener','canvas','button','511QXZDPO','clear','coordsInput','Login\x20to\x20draw!','pixellox','clearRect','templateFile','27990MEOIqb','#ccc','value','rgb(0,\x200,\x200)','Come\x20in!','world.png'];_0xc873=function(){return _0x5e83cd;};return _0xc873();}let isPanning=![],lastMouseX=0x0,lastMouseY=0x0;function clamp(_0x3d673a,_0x466700,_0x4cd15f){const _0x4533af=_0x5cbc87;return Math['max'](_0x466700,Math[_0x4533af(0x1d6)](_0x4cd15f,_0x3d673a));}function screenToWorld(_0x37224e,_0x5b17a4){const _0xfb4260=_0x5cbc87,_0x78d37=game[_0xfb4260(0x1f0)](),_0x45207e=(_0x37224e-_0x78d37[_0xfb4260(0x1b5)])/scale+camX,_0x575bbd=(_0x5b17a4-_0x78d37['top'])/scale+camY;return[_0x45207e,_0x575bbd];}function _0x16e4(_0x54b0b6,_0x43bead){const _0xc87313=_0xc873();return _0x16e4=function(_0x16e44e,_0x39490e){_0x16e44e=_0x16e44e-0x183;let _0x13e894=_0xc87313[_0x16e44e];return _0x13e894;},_0x16e4(_0x54b0b6,_0x43bead);}function snapToGrid(_0x2fc180,_0xad07e2){const _0x4fa4a4=_0x5cbc87;return[Math['floor'](_0x2fc180/gridCellSize)*gridCellSize,Math[_0x4fa4a4(0x1d2)](_0xad07e2/gridCellSize)*gridCellSize];}let hoverCellX=0x0,hoverCellY=0x0;const pixelsCache=new Map();let markers=[];function updateCoordsDisplay(){const _0x32c622=_0x5cbc87;if(!coordsDisplayEl)return;const _0x447369=Math['floor'](hoverCellX/gridCellSize),_0x1c9ba2=Math[_0x32c622(0x1d2)](hoverCellY/gridCellSize);coordsDisplayEl[_0x32c622(0x201)]='X:\x20'+_0x447369+_0x32c622(0x20c)+_0x1c9ba2;}const TILE_SIZE=0x3e8;let tiles=[];const offscreenCanvas=document['createElement'](_0x5cbc87(0x20e));offscreenCanvas['width']=TILE_SIZE,offscreenCanvas['height']=TILE_SIZE;const offCtx=offscreenCanvas[_0x5cbc87(0x1a8)]('2d',{'willReadFrequently':!![]});offCtx['imageSmoothingEnabled']=![],worldMap[_0x5cbc87(0x1e4)]=()=>{const _0x5ba6fc=_0x5cbc87,_0xc57853=worldMap[_0x5ba6fc(0x189)]||0x4e20,_0x1f3181=worldMap[_0x5ba6fc(0x1fb)]||0x4e20;WORLD_W=_0xc57853*SCALE_TILE,WORLD_H=_0x1f3181*SCALE_TILE;const _0x3c3fb3=Math[_0x5ba6fc(0x21f)](_0xc57853/TILE_SIZE),_0x505606=Math[_0x5ba6fc(0x21f)](_0x1f3181/TILE_SIZE);tiles=[];for(let _0xf49377=0x0;_0xf49377<_0x3c3fb3;_0xf49377++){for(let _0x1ea038=0x0;_0x1ea038<_0x505606;_0x1ea038++){const _0x460a2d=_0xf49377*TILE_SIZE,_0x14085c=_0x1ea038*TILE_SIZE,_0x38aeb3=Math[_0x5ba6fc(0x1d6)](TILE_SIZE,_0xc57853-_0x460a2d),_0x4c0eb7=Math[_0x5ba6fc(0x1d6)](TILE_SIZE,_0x1f3181-_0x14085c);offCtx[_0x5ba6fc(0x215)](0x0,0x0,TILE_SIZE,TILE_SIZE),offCtx[_0x5ba6fc(0x207)](worldMap,_0x460a2d,_0x14085c,_0x38aeb3,_0x4c0eb7,0x0,0x0,_0x38aeb3,_0x4c0eb7);const _0x55d611=new Image();_0x55d611[_0x5ba6fc(0x1e7)]=offscreenCanvas[_0x5ba6fc(0x197)]('image/png');const _0x5263d4=_0x460a2d*SCALE_TILE,_0x3de439=_0x14085c*SCALE_TILE,_0x40d152=_0x38aeb3*SCALE_TILE,_0xb4ad60=_0x4c0eb7*SCALE_TILE;tiles[_0x5ba6fc(0x1a1)]({'img':_0x55d611,'dx':_0x5263d4,'dy':_0x3de439,'dw':_0x40d152,'dh':_0xb4ad60});}}renderAll();};function renderAll(){const _0x581f58=_0x5cbc87;ctx[_0x581f58(0x204)]=![],ctx[_0x581f58(0x1d9)](0x1,0x0,0x0,0x1,0x0,0x0),ctx[_0x581f58(0x215)](0x0,0x0,game[_0x581f58(0x1e3)],game[_0x581f58(0x221)]),ctx['setTransform'](scale,0x0,0x0,scale,-camX*scale,-camY*scale);const _0x3283b5=camX,_0x62f100=camY,_0x2e4693=camX+game['width']/scale,_0x3175e7=camY+game[_0x581f58(0x221)]/scale;for(const _0x57768a of tiles){if(_0x57768a['dx']+_0x57768a['dw']<_0x3283b5||_0x57768a['dx']>_0x2e4693||_0x57768a['dy']+_0x57768a['dh']<_0x62f100||_0x57768a['dy']>_0x3175e7)continue;_0x57768a[_0x581f58(0x1b9)]['complete']&&_0x57768a[_0x581f58(0x1b9)][_0x581f58(0x189)]?ctx[_0x581f58(0x207)](_0x57768a[_0x581f58(0x1b9)],_0x57768a['dx'],_0x57768a['dy'],_0x57768a['dw'],_0x57768a['dh']):(ctx[_0x581f58(0x190)]=_0x581f58(0x1d8),ctx[_0x581f58(0x1eb)](_0x57768a['dx'],_0x57768a['dy'],_0x57768a['dw'],_0x57768a['dh']));}ctx[_0x581f58(0x205)](),ctx[_0x581f58(0x1f2)]=_0x581f58(0x218);let _0x442ba4=Math[_0x581f58(0x1d2)](_0x3283b5/gridCellSize)*gridCellSize;for(let _0x4a4182=_0x442ba4;_0x4a4182<=_0x2e4693;_0x4a4182+=gridCellSize){ctx[_0x581f58(0x1e8)](_0x4a4182,_0x62f100),ctx['lineTo'](_0x4a4182,_0x3175e7);}let _0x49e044=Math[_0x581f58(0x1d2)](_0x62f100/gridCellSize)*gridCellSize;for(let _0x2fc994=_0x49e044;_0x2fc994<=_0x3175e7;_0x2fc994+=gridCellSize){ctx[_0x581f58(0x1e8)](_0x3283b5,_0x2fc994),ctx[_0x581f58(0x1e1)](_0x2e4693,_0x2fc994);}ctx[_0x581f58(0x1ba)](),pixelsCache[_0x581f58(0x1b1)](_0xdd99c3=>{const _0x3c51d7=_0x581f58;_0xdd99c3[_0x3c51d7(0x193)]!==_0x3c51d7(0x1f6)&&(ctx['fillStyle']=_0xdd99c3[_0x3c51d7(0x193)],ctx['fillRect'](_0xdd99c3['x'],_0xdd99c3['y'],gridCellSize,gridCellSize));}),ctx[_0x581f58(0x190)]='rgba(255,0,0,0.5)';for(const [_0x33f171,_0x4d6135]of markers){ctx['fillRect'](_0x33f171,_0x4d6135,gridCellSize,gridCellSize);}ctx['fillStyle']='rgba(0,0,0,0.12)',ctx[_0x581f58(0x1eb)](hoverCellX,hoverCellY,gridCellSize,gridCellSize),ctx['setTransform'](0x1,0x0,0x0,0x1,0x0,0x0);}onSnapshot(collection(db,_0x5cbc87(0x1c3)),_0x2666b3=>{const _0x4581ea=_0x5cbc87;pixelsCache[_0x4581ea(0x211)](),_0x2666b3[_0x4581ea(0x1b1)](_0x37de7e=>{const _0x369c03=_0x4581ea,_0x562420=_0x37de7e[_0x369c03(0x1da)]();pixelsCache['set'](_0x562420['x']+'-'+_0x562420['y'],_0x562420);}),renderAll();}),game[_0x5cbc87(0x20d)](_0x5cbc87(0x1be),_0x452259=>{const _0x25aaa7=_0x5cbc87;(_0x452259[_0x25aaa7(0x20f)]===0x1||_0x452259['button']===0x2||_0x452259[_0x25aaa7(0x1a9)]||_0x452259[_0x25aaa7(0x1ae)]||_0x452259[_0x25aaa7(0x195)]||_0x452259['altKey'])&&(isPanning=!![],lastMouseX=_0x452259[_0x25aaa7(0x188)],lastMouseY=_0x452259[_0x25aaa7(0x1d0)],_0x452259[_0x25aaa7(0x1b4)]());}),window[_0x5cbc87(0x20d)](_0x5cbc87(0x1a5),()=>{isPanning=![];}),game[_0x5cbc87(0x20d)](_0x5cbc87(0x1ce),_0x275136=>_0x275136[_0x5cbc87(0x1b4)]()),game[_0x5cbc87(0x20d)]('mousemove',_0x54bd76=>{const _0x55e4a5=_0x5cbc87;if(isPanning){const _0x31a5e9=_0x54bd76[_0x55e4a5(0x188)]-lastMouseX,_0x5311f0=_0x54bd76[_0x55e4a5(0x1d0)]-lastMouseY;camX-=_0x31a5e9/scale,camY-=_0x5311f0/scale,lastMouseX=_0x54bd76[_0x55e4a5(0x188)],lastMouseY=_0x54bd76[_0x55e4a5(0x1d0)],renderAll();}const [_0x29c6cf,_0x45dad4]=screenToWorld(_0x54bd76['clientX'],_0x54bd76[_0x55e4a5(0x1d0)]);[hoverCellX,hoverCellY]=snapToGrid(_0x29c6cf,_0x45dad4),updateCoordsDisplay(),renderAll();}),game['addEventListener'](_0x5cbc87(0x1b2),_0x1f089f=>{const _0x3570b7=_0x5cbc87;_0x1f089f['preventDefault']();const _0x574c1b=1.1,[_0x5bbe4a,_0x407e71]=screenToWorld(_0x1f089f['clientX'],_0x1f089f[_0x3570b7(0x1d0)]),_0x33b905=_0x1f089f[_0x3570b7(0x1de)]<0x0?0x1:-0x1,_0x38be7b=clamp(scale*(_0x33b905>0x0?_0x574c1b:0x1/_0x574c1b),MIN_SCALE,MAX_SCALE);if(_0x38be7b===scale)return;scale=_0x38be7b;const _0x3c2fc7=game[_0x3570b7(0x1f0)]();camX=_0x5bbe4a-(_0x1f089f[_0x3570b7(0x188)]-_0x3c2fc7[_0x3570b7(0x1b5)])/scale,camY=_0x407e71-(_0x1f089f[_0x3570b7(0x1d0)]-_0x3c2fc7['top'])/scale;const [_0x2c0bc0,_0x569ac9]=screenToWorld(_0x1f089f[_0x3570b7(0x188)],_0x1f089f[_0x3570b7(0x1d0)]);[hoverCellX,hoverCellY]=snapToGrid(_0x2c0bc0,_0x569ac9),updateCoordsDisplay(),renderAll();},{'passive':![]});async function placePixelWithHover(){const _0x12620d=_0x5cbc87;if(!auth[_0x12620d(0x185)])return alert(_0x12620d(0x213));if(!canPlace)return;canPlace=![];const _0x422646=hoverCellX,_0x10be6c=hoverCellY,_0x13e4ac=doc(db,_0x12620d(0x1c3),_0x422646+'-'+_0x10be6c);try{if(currentColor==='#FFFFFF')await deleteDoc(_0x13e4ac);else await setDoc(_0x13e4ac,{'x':_0x422646,'y':_0x10be6c,'color':currentColor});}catch(_0x3be84c){console[_0x12620d(0x1ab)](_0x3be84c);}startReload();}game[_0x5cbc87(0x20d)]('click',_0x2c58af=>{const _0x413e77=_0x5cbc87;if(isPanning||_0x2c58af[_0x413e77(0x20f)]!==0x0)return;placePixelWithHover();});if(cursor)cursor['style'][_0x5cbc87(0x198)]='none';function startReload(){const _0x19222b=_0x5cbc87;let _0x508ccb=reloadTime;reloadTimerEl[_0x19222b(0x19c)]='Reload:\x20'+_0x508ccb+_0x19222b(0x1b7);const _0x199beb=setInterval(()=>{const _0x44da64=_0x19222b;_0x508ccb--;if(_0x508ccb<=0x0)clearInterval(_0x199beb),canPlace=!![],reloadTimerEl['innerText']=_0x44da64(0x20b);else reloadTimerEl[_0x44da64(0x19c)]=_0x44da64(0x1ee)+_0x508ccb+_0x44da64(0x1b7);},0x3e8);}authButton[_0x5cbc87(0x20d)]('click',async()=>{const _0x4fd3db=_0x5cbc87;if(auth[_0x4fd3db(0x185)]){await signOut(auth);return;}const _0x34953f=prompt(_0x4fd3db(0x222));if(!_0x34953f||_0x34953f!=='1'&&_0x34953f!=='2')return;const _0x2e71ab=prompt(_0x4fd3db(0x1a4)),_0x445ee1=prompt('Password:');if(!_0x2e71ab||!_0x445ee1)return;try{_0x34953f==='1'?(await signInWithEmailAndPassword(auth,_0x2e71ab,_0x445ee1),alert(_0x4fd3db(0x21b))):(await createUserWithEmailAndPassword(auth,_0x2e71ab,_0x445ee1),alert(_0x4fd3db(0x1f3)));}catch(_0x1c5c75){alert(_0x1c5c75[_0x4fd3db(0x1ea)]);}}),onAuthStateChanged(auth,_0x22599b=>{const _0x4e61a7=_0x5cbc87;_0x22599b?(authButton[_0x4e61a7(0x201)]='Log\x20Out',_0x22599b[_0x4e61a7(0x1dd)]===_0x4e61a7(0x1e0)?adminPanel[_0x4e61a7(0x187)]['display']=_0x4e61a7(0x1c1):adminPanel[_0x4e61a7(0x187)][_0x4e61a7(0x198)]=_0x4e61a7(0x1aa)):(authButton[_0x4e61a7(0x201)]=_0x4e61a7(0x1d4),adminPanel['style']['display']=_0x4e61a7(0x1aa));});function parseCoords(){const _0x23521a=_0x5cbc87;markers=[];const _0x4861a2=coordsInput['value'][_0x23521a(0x19f)]();if(!_0x4861a2){renderAll();return;}_0x4861a2[_0x23521a(0x206)](',')['forEach'](_0x8fd746=>{const _0x1b8c2c=_0x23521a,[_0x797505,_0x2dfded,_0x4228b5,_0x518953]=_0x8fd746[_0x1b8c2c(0x19f)]()['split'](/\s+/),_0xfaf90f=parseInt(_0x797505),_0x6d3ef2=parseInt(_0x2dfded),_0x1563e4=parseInt(_0x4228b5||'1'),_0x1ee5e2=parseInt(_0x518953||'1');if(Number[_0x1b8c2c(0x1c9)](_0xfaf90f)||Number[_0x1b8c2c(0x1c9)](_0x6d3ef2)||Number[_0x1b8c2c(0x1c9)](_0x1563e4)||Number[_0x1b8c2c(0x1c9)](_0x1ee5e2))return;const _0x349218=_0xfaf90f*gridCellSize,_0x1d3519=_0x6d3ef2*gridCellSize;for(let _0x55ea7c=0x0;_0x55ea7c<_0x1563e4;_0x55ea7c++){for(let _0x31aef7=0x0;_0x31aef7<_0x1ee5e2;_0x31aef7++){const _0xf62ecb=_0x349218+_0x55ea7c*gridCellSize,_0x35c090=_0x1d3519+_0x31aef7*gridCellSize;_0xf62ecb>=0x0&&_0x35c090>=0x0&&_0xf62ecb<=WORLD_W-gridCellSize&&_0x35c090<=WORLD_H-gridCellSize&&markers['push']([_0xf62ecb,_0x35c090]);}}}),renderAll();}const upBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1b3)),downBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x19a)),leftBtn=document[_0x5cbc87(0x1fa)]('leftBtn'),rightBtn=document[_0x5cbc87(0x1fa)]('rightBtn'),zoomInBtn=document['getElementById'](_0x5cbc87(0x1d7)),zoomOutBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1cb)),moveSpeed=0x32,zoomFactorBtn=1.2;function moveCamera(_0x383e6b,_0x5e7880){camX+=_0x383e6b/scale,camY+=_0x5e7880/scale,renderAll();}upBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>moveCamera(0x0,-moveSpeed)),downBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>moveCamera(0x0,moveSpeed)),leftBtn[_0x5cbc87(0x20d)]('click',()=>moveCamera(-moveSpeed,0x0)),rightBtn['addEventListener']('click',()=>moveCamera(moveSpeed,0x0)),zoomInBtn[_0x5cbc87(0x20d)]('click',()=>{const _0x32d735=clamp(scale*zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x32d735,renderAll();}),zoomOutBtn[_0x5cbc87(0x20d)]('click',()=>{const _0x2ff371=clamp(scale/zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x2ff371,renderAll();}),coordsInput[_0x5cbc87(0x20d)](_0x5cbc87(0x1f4),parseCoords);async function adminApplyPixels(_0x5729cb){const _0x23ae47=_0x5cbc87;if(!auth[_0x23ae47(0x185)]||auth[_0x23ae47(0x185)][_0x23ae47(0x1dd)]!==_0x23ae47(0x1e0))return alert('Только\x20админ!');parseCoords();let _0x4681f9=0x0;for(const [_0x51f523,_0x4cdb4c]of markers){const _0x1e6595=doc(db,_0x23ae47(0x1c3),_0x51f523+'-'+_0x4cdb4c);_0x5729cb===_0x23ae47(0x1f8)?(await setDoc(_0x1e6595,{'x':_0x51f523,'y':_0x4cdb4c,'color':currentColor}),_0x4681f9++):(await deleteDoc(_0x1e6595),_0x4681f9++);}alert((_0x5729cb===_0x23ae47(0x1f8)?'Добавлено':'Удалено')+'\x20пикселей:\x20'+_0x4681f9);}addPixelBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>adminApplyPixels(_0x5cbc87(0x1f8))),removePixelBtn['addEventListener'](_0x5cbc87(0x1cd),()=>adminApplyPixels(_0x5cbc87(0x209))),clearAllPixelsBtn[_0x5cbc87(0x20d)]('click',async()=>{const _0x139f4d=_0x5cbc87;if(!auth[_0x139f4d(0x185)])return alert(_0x139f4d(0x220));const _0x54490d=await getDocs(collection(db,_0x139f4d(0x1c3)));_0x54490d[_0x139f4d(0x1b1)](_0x4c726e=>deleteDoc(_0x4c726e[_0x139f4d(0x1bd)]));}),banUserBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>{const _0x157961=_0x5cbc87;if(!auth['currentUser'])return alert(_0x157961(0x220));const _0x467486=prompt(_0x157961(0x1a7));if(!_0x467486)return;const _0x534c90=ref(rtdb,_0x157961(0x1af)+_0x467486);remove(_0x534c90)[_0x157961(0x1ed)](()=>alert('Пользователь\x20забанен!'))['catch'](_0x5b53f6=>console['error'](_0x5b53f6));});import{onDisconnect,set}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';function trackOnlinePlayer(){const _0xaa2d7a=_0x5cbc87;if(!auth['currentUser'])return;const _0x351db8=auth['currentUser']['uid'],_0x1d8ebb=ref(rtdb,_0xaa2d7a(0x1af)+_0x351db8);set(_0x1d8ebb,{'email':auth[_0xaa2d7a(0x185)][_0xaa2d7a(0x1dd)],'lastSeen':Date[_0xaa2d7a(0x18d)]()}),onDisconnect(_0x1d8ebb)['remove']();}onAuthStateChanged(auth,_0x6cde9a=>{_0x6cde9a&&trackOnlinePlayer();});function updateOnlinePlayers(){const _0x14e466=ref(rtdb,'users/');onValue(_0x14e466,_0x507114=>{const _0x242dd0=_0x16e4,_0x3e7fa7=_0x507114[_0x242dd0(0x1bc)](),_0x3477a2=_0x3e7fa7?Object['keys'](_0x3e7fa7)[_0x242dd0(0x20a)]:0x0;onlinePlayersEl[_0x242dd0(0x19c)]=_0x242dd0(0x1b8)+_0x3477a2;});}updateOnlinePlayers();const overlay=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x199)),fileInput=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x216)),opacityRange=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1e5)),coordX=document['getElementById'](_0x5cbc87(0x196)),coordY=document['getElementById'](_0x5cbc87(0x1ec)),applyCoordsBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x18c)),toggleBtn=document[_0x5cbc87(0x1fa)](_0x5cbc87(0x1df));let templateX=0x0,templateY=0x0,templateOpacity=0.5,templateVisible=!![];fileInput['addEventListener'](_0x5cbc87(0x1f1),_0x2a991c=>{const _0x432d2a=_0x5cbc87,_0x57b35c=_0x2a991c[_0x432d2a(0x1f5)][_0x432d2a(0x1c0)][0x0];if(!_0x57b35c)return;const _0x2818e3=new FileReader();_0x2818e3[_0x432d2a(0x1e4)]=_0x35104c=>{const _0x4d2708=_0x432d2a;overlay['src']=_0x35104c['target'][_0x4d2708(0x1e9)],overlay[_0x4d2708(0x187)][_0x4d2708(0x198)]='block';},_0x2818e3[_0x432d2a(0x1cc)](_0x57b35c);}),opacityRange[_0x5cbc87(0x20d)](_0x5cbc87(0x1f4),()=>{const _0x1cdbca=_0x5cbc87;templateOpacity=opacityRange['value'],overlay['style'][_0x1cdbca(0x191)]=templateOpacity;}),applyCoordsBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>{const _0x35c962=_0x5cbc87;templateX=parseInt(coordX[_0x35c962(0x219)])||0x0,templateY=parseInt(coordY['value'])||0x0,updateTemplatePosition();}),toggleBtn[_0x5cbc87(0x20d)](_0x5cbc87(0x1cd),()=>{const _0xbdfd73=_0x5cbc87;templateVisible=!templateVisible,overlay[_0xbdfd73(0x187)]['display']=templateVisible?_0xbdfd73(0x1c1):_0xbdfd73(0x1aa);});function updateTemplatePosition(){const _0x52c0f5=_0x5cbc87;overlay[_0x52c0f5(0x187)][_0x52c0f5(0x1ad)]='translate('+(-camX*scale+templateX)+_0x52c0f5(0x1a3)+(-camY*scale+templateY)+_0x52c0f5(0x225)+scale+')',overlay[_0x52c0f5(0x187)]['transformOrigin']=_0x52c0f5(0x223);}const oldRenderAll=renderAll;renderAll=function(){const _0x27104c=_0x5cbc87;oldRenderAll();if(overlay[_0x27104c(0x1e7)])updateTemplatePosition();};
