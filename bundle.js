const _0x355fba=_0x5d56;(function(_0x2a4e1f,_0x23857b){const _0x2dfce6=_0x5d56,_0x5209eb=_0x2a4e1f();while(!![]){try{const _0x498d8c=-parseInt(_0x2dfce6(0x22e))/0x1+parseInt(_0x2dfce6(0x208))/0x2*(-parseInt(_0x2dfce6(0x243))/0x3)+-parseInt(_0x2dfce6(0x225))/0x4*(parseInt(_0x2dfce6(0x1f6))/0x5)+parseInt(_0x2dfce6(0x241))/0x6+-parseInt(_0x2dfce6(0x26e))/0x7+parseInt(_0x2dfce6(0x267))/0x8*(parseInt(_0x2dfce6(0x228))/0x9)+parseInt(_0x2dfce6(0x239))/0xa*(parseInt(_0x2dfce6(0x1ea))/0xb);if(_0x498d8c===_0x23857b)break;else _0x5209eb['push'](_0x5209eb['shift']());}catch(_0x2c2e74){_0x5209eb['push'](_0x5209eb['shift']());}}}(_0x2ff1,0x2bbaf));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js';import{getFirestore,collection,doc,setDoc,onSnapshot,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js';import{getDatabase,ref,remove}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';import{getAuth,onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js';const firebaseConfig={'apiKey':_0x355fba(0x1f0),'authDomain':_0x355fba(0x21b),'projectId':_0x355fba(0x202),'storageBucket':_0x355fba(0x23d),'messagingSenderId':_0x355fba(0x1df),'appId':_0x355fba(0x265)},app=initializeApp(firebaseConfig),db=getFirestore(app),rtdb=getDatabase(app),auth=getAuth(app),coordsDisplayEl=document[_0x355fba(0x21c)](_0x355fba(0x253)),colorsChoiceEl=document[_0x355fba(0x21c)]('colorsChoice'),paletteToggle=document[_0x355fba(0x21c)](_0x355fba(0x1f7)),game=document[_0x355fba(0x21c)](_0x355fba(0x226)),ctx=game[_0x355fba(0x1c9)]('2d'),cursor=document[_0x355fba(0x21c)](_0x355fba(0x203)),reloadTimerEl=document[_0x355fba(0x21c)](_0x355fba(0x1db)),adminPanel=document[_0x355fba(0x21c)](_0x355fba(0x221)),clearAllPixelsBtn=document[_0x355fba(0x21c)](_0x355fba(0x270)),banUserBtn=document[_0x355fba(0x21c)]('banUser'),authButton=document[_0x355fba(0x21c)](_0x355fba(0x1e8)),coordsInput=document[_0x355fba(0x21c)]('coordsInput'),addPixelBtn=document['getElementById'](_0x355fba(0x216)),removePixelBtn=document[_0x355fba(0x21c)]('removePixelBtn'),teleportInput=document[_0x355fba(0x21c)]('teleportInput'),teleportBtn=document[_0x355fba(0x21c)](_0x355fba(0x1c3));teleportBtn[_0x355fba(0x1e9)](_0x355fba(0x24c),()=>{const _0x19b263=_0x355fba;if(!auth['currentUser']||auth[_0x19b263(0x26c)]['email']!==_0x19b263(0x21d))return alert(_0x19b263(0x215));const _0x40adc9=teleportInput[_0x19b263(0x222)]['trim']();if(!_0x40adc9)return;const [_0x4a07b7,_0x18e92d]=_0x40adc9[_0x19b263(0x238)](/\s+/),_0x2bfa32=parseInt(_0x4a07b7),_0x14cbdb=parseInt(_0x18e92d);if(Number[_0x19b263(0x1c5)](_0x2bfa32)||Number[_0x19b263(0x1c5)](_0x14cbdb))return alert(_0x19b263(0x1cf));const _0x304184=_0x2bfa32*gridCellSize,_0x38c3cf=_0x14cbdb*gridCellSize;camX=_0x304184-game[_0x19b263(0x24d)]/0x2/scale,camY=_0x38c3cf-game[_0x19b263(0x213)]/0x2/scale,renderAll();}),ctx[_0x355fba(0x271)]=![];const gridCellSize=0xa;game[_0x355fba(0x24d)]=0x4b0,game['height']=0x258;function _0x2ff1(){const _0x5eeade=['cursor','innerText','image/png','#colorsChoice\x20div','remove','7520erjOXr','result','naturalHeight','rgb(0,\x200,\x20234)','zoomOutBtn','rgb(229,\x200,\x200)','complete','touchstart','preventDefault','Password:','Log\x20In','height','downBtn','Только\x20админ!','addPixelBtn','img','setTransform','touches','rgb(245,\x20223,\x20176)','pixellox.firebaseapp.com','getElementById','logo100153@gmail.com','fillRect','error','readAsDataURL','adminPanel','value','classList','rgb(255,\x20167,\x20209)','1456QkfJCn','game','X:\x20','36PeqPko','opacityRange','querySelectorAll','color','deltaY','rgb(228,\x20228,\x20228)','106134MKwAZk','email','rgb(0,\x20101,\x2019)','src','rgb(255,\x20255,\x20255)','world.png','clear','createElement','px,\x20','rgb(202,\x20227,\x20255)','split','810wpvTOe','add','colorsChoice','length','pixellox.firebasestorage.app','files','change','canvas','488298qwlsMA','mousedown','96Olzeih','target','min','forEach','rgb(130,\x200,\x20128)','clientX','push','getBoundingClientRect','#000000','click','width','appendChild','ref','fillStyle','clientY','rgb(207,\x20110,\x20228)','coordsDisplay','now','users/','Удалено','ctrlKey','toDataURL','Login\x20to\x20draw!','pixels','selected','contextmenu','then','Log\x20Out','drawImage','message','Come\x20in!','Добавлено','coordY','rgb(255,\x2084,\x20178)','1:461991610382:web:2a5ae293dde4a754c2d45f','rgb(25,\x2025,\x20115)','188024svgXgu','rgb(148,\x20224,\x2068)','wheel','rgb(0,\x20211,\x20221)','rgb(255,\x20248,\x20137)','currentUser','display','1550269atGjCe','clearRect','clearAllPixels','imageSmoothingEnabled','altKey','none','rgb(196,\x20196,\x20196)','rgb(136,\x20136,\x20136)','mousemove','touchend','innerHTML','rgb(255,\x20101,\x20101)','teleportBtn','templateFile','isNaN','trim','set','upBtn','getContext','transform','ceil','grid','zoomInBtn','#eef6ff','Введите\x20корректные\x20координаты\x20X\x20Y','coordX','stroke','floor','rgb(0,\x20131,\x20199)','Reload:\x20','rgb(78,\x2078,\x2078)','rgba(255,0,0,0.5)','catch','style','rgba(0,0,0,0.12)','rgb(229,\x20149,\x200)','reloadTimer','rgb(0,\x200,\x200)','Email:','strokeStyle','461991610382','button','rightBtn','input','Enter\x201\x20to\x20sign\x20in,\x20or\x202\x20to\x20create\x20a\x20new\x20account:','rgb(104,\x20131,\x2056)','rgb(96,\x2064,\x2040)','\x20sec','rgb(244,\x20179,\x20174)','authButton','addEventListener','72259RoLGqQ','top','px)\x20scale(','rgb(254,\x20164,\x2096)','Введите\x20UserID\x20для\x20бана:','block','AIzaSyCwy4jVn9JIwXuIXVycYAv9EdPGPkgIJvA','shiftKey','div','moveTo','onload','transformOrigin','1105ggleXd','paletteToggle','lineTo','Ready!','Пользователь\x20забанен!','val','textContent','naturalWidth','opacity','left','toggleBtn','Account\x20created!','pixellox'];_0x2ff1=function(){return _0x5eeade;};return _0x2ff1();}let currentColor=_0x355fba(0x24b),canPlace=!![];const reloadTime=0x5,colors=[_0x355fba(0x232),_0x355fba(0x1e5),_0x355fba(0x22d),_0x355fba(0x21a),_0x355fba(0x1bd),_0x355fba(0x26b),_0x355fba(0x1be),'rgb(229,\x20217,\x200)',_0x355fba(0x1d5),_0x355fba(0x268),_0x355fba(0x1dc),'rgb(2,\x20190,\x201)',_0x355fba(0x1e7),_0x355fba(0x1e4),_0x355fba(0x224),_0x355fba(0x230),_0x355fba(0x264),_0x355fba(0x237),_0x355fba(0x1c2),_0x355fba(0x26a),_0x355fba(0x20d),_0x355fba(0x1d3),'rgb(154,\x200,\x200)',_0x355fba(0x20b),_0x355fba(0x1ed),_0x355fba(0x266),_0x355fba(0x1da),_0x355fba(0x252),'rgb(160,\x20106,\x2066)',_0x355fba(0x247)];colorsChoiceEl[_0x355fba(0x1c1)]='',colors[_0x355fba(0x246)](_0x510e1c=>{const _0x59f411=_0x355fba,_0x33292f=document[_0x59f411(0x235)](_0x59f411(0x1f2));_0x33292f[_0x59f411(0x1d8)]['backgroundColor']=_0x510e1c,_0x33292f[_0x59f411(0x1e9)](_0x59f411(0x24c),()=>{const _0x212f25=_0x59f411;currentColor=_0x510e1c,document[_0x212f25(0x22a)](_0x212f25(0x206))['forEach'](_0x1e5cde=>_0x1e5cde['classList'][_0x212f25(0x207)](_0x212f25(0x25b))),_0x33292f[_0x212f25(0x223)][_0x212f25(0x23a)](_0x212f25(0x25b));}),colorsChoiceEl[_0x59f411(0x24e)](_0x33292f);});const colorsChoice=document[_0x355fba(0x21c)](_0x355fba(0x23b)),togglePalette=document[_0x355fba(0x21c)]('togglePalette');togglePalette['addEventListener']('click',()=>{const _0x15be89=_0x355fba;colorsChoice[_0x15be89(0x1d8)]['display']===_0x15be89(0x1bc)?colorsChoice[_0x15be89(0x1d8)]['display']=_0x15be89(0x1cc):colorsChoice[_0x15be89(0x1d8)]['display']=_0x15be89(0x1bc);});const worldMap=new Image();worldMap['src']=_0x355fba(0x233);const SCALE_TILE=0x28;let WORLD_W=0x4e20*SCALE_TILE,WORLD_H=0x4e20*SCALE_TILE,camX=0x0,camY=0x0,scale=0x1;const MIN_SCALE=0.005,MAX_SCALE=0x6;let isPanning=![],lastMouseX=0x0,lastMouseY=0x0;function clamp(_0x173aaf,_0x5e0a84,_0x37ace9){const _0x112216=_0x355fba;return Math['max'](_0x5e0a84,Math[_0x112216(0x245)](_0x37ace9,_0x173aaf));}function screenToWorld(_0xdaca8e,_0x27065b){const _0x1a6109=_0x355fba,_0x567c8d=game[_0x1a6109(0x24a)](),_0x2182ec=(_0xdaca8e-_0x567c8d[_0x1a6109(0x1ff)])/scale+camX,_0x45acd2=(_0x27065b-_0x567c8d[_0x1a6109(0x1eb)])/scale+camY;return[_0x2182ec,_0x45acd2];}function snapToGrid(_0x3fe349,_0x10a527){return[Math['floor'](_0x3fe349/gridCellSize)*gridCellSize,Math['floor'](_0x10a527/gridCellSize)*gridCellSize];}let hoverCellX=0x0,hoverCellY=0x0;const pixelsCache=new Map();let markers=[];function updateCoordsDisplay(){const _0x4d0ca9=_0x355fba;if(!coordsDisplayEl)return;const _0x4ec4eb=Math[_0x4d0ca9(0x1d2)](hoverCellX/gridCellSize),_0x4c2df6=Math[_0x4d0ca9(0x1d2)](hoverCellY/gridCellSize);coordsDisplayEl['textContent']=_0x4d0ca9(0x227)+_0x4ec4eb+'\x20\x20Y:\x20'+_0x4c2df6;}const TILE_SIZE=0x3e8;let tiles=[];const offscreenCanvas=document[_0x355fba(0x235)](_0x355fba(0x240));offscreenCanvas[_0x355fba(0x24d)]=TILE_SIZE,offscreenCanvas[_0x355fba(0x213)]=TILE_SIZE;const offCtx=offscreenCanvas[_0x355fba(0x1c9)]('2d',{'willReadFrequently':!![]});offCtx[_0x355fba(0x271)]=![],worldMap[_0x355fba(0x1f4)]=()=>{const _0x16febb=_0x355fba,_0x971562=worldMap[_0x16febb(0x1fd)]||0x4e20,_0x242319=worldMap[_0x16febb(0x20a)]||0x4e20;WORLD_W=_0x971562*SCALE_TILE,WORLD_H=_0x242319*SCALE_TILE;const _0x34361b=Math['ceil'](_0x971562/TILE_SIZE),_0x1b6d37=Math[_0x16febb(0x1cb)](_0x242319/TILE_SIZE);tiles=[];for(let _0x2af938=0x0;_0x2af938<_0x34361b;_0x2af938++){for(let _0x21de73=0x0;_0x21de73<_0x1b6d37;_0x21de73++){const _0xcd0f62=_0x2af938*TILE_SIZE,_0x519f95=_0x21de73*TILE_SIZE,_0x2c0ac4=Math[_0x16febb(0x245)](TILE_SIZE,_0x971562-_0xcd0f62),_0x317706=Math[_0x16febb(0x245)](TILE_SIZE,_0x242319-_0x519f95);offCtx[_0x16febb(0x26f)](0x0,0x0,TILE_SIZE,TILE_SIZE),offCtx[_0x16febb(0x25f)](worldMap,_0xcd0f62,_0x519f95,_0x2c0ac4,_0x317706,0x0,0x0,_0x2c0ac4,_0x317706);const _0x229edc=new Image();_0x229edc[_0x16febb(0x231)]=offscreenCanvas[_0x16febb(0x258)](_0x16febb(0x205));const _0x59f2ab=_0xcd0f62*SCALE_TILE,_0x52faa0=_0x519f95*SCALE_TILE,_0x1c3f41=_0x2c0ac4*SCALE_TILE,_0x2a5c27=_0x317706*SCALE_TILE;tiles[_0x16febb(0x249)]({'img':_0x229edc,'dx':_0x59f2ab,'dy':_0x52faa0,'dw':_0x1c3f41,'dh':_0x2a5c27});}}renderAll();};function renderAll(){const _0x2d658f=_0x355fba;ctx[_0x2d658f(0x271)]=![],ctx[_0x2d658f(0x218)](0x1,0x0,0x0,0x1,0x0,0x0),ctx[_0x2d658f(0x26f)](0x0,0x0,game[_0x2d658f(0x24d)],game[_0x2d658f(0x213)]),ctx[_0x2d658f(0x218)](scale,0x0,0x0,scale,-camX*scale,-camY*scale);const _0x2b833d=camX,_0x5cbc6d=camY,_0x27c379=camX+game[_0x2d658f(0x24d)]/scale,_0x286aab=camY+game['height']/scale;for(const _0x35a159 of tiles){if(_0x35a159['dx']+_0x35a159['dw']<_0x2b833d||_0x35a159['dx']>_0x27c379||_0x35a159['dy']+_0x35a159['dh']<_0x5cbc6d||_0x35a159['dy']>_0x286aab)continue;_0x35a159[_0x2d658f(0x217)][_0x2d658f(0x20e)]&&_0x35a159[_0x2d658f(0x217)][_0x2d658f(0x1fd)]?ctx[_0x2d658f(0x25f)](_0x35a159[_0x2d658f(0x217)],_0x35a159['dx'],_0x35a159['dy'],_0x35a159['dw'],_0x35a159['dh']):(ctx[_0x2d658f(0x250)]=_0x2d658f(0x1ce),ctx['fillRect'](_0x35a159['dx'],_0x35a159['dy'],_0x35a159['dw'],_0x35a159['dh']));}ctx['beginPath'](),ctx[_0x2d658f(0x1de)]='#ccc';let _0x492a1d=Math[_0x2d658f(0x1d2)](_0x2b833d/gridCellSize)*gridCellSize;for(let _0x4151c4=_0x492a1d;_0x4151c4<=_0x27c379;_0x4151c4+=gridCellSize){ctx[_0x2d658f(0x1f3)](_0x4151c4,_0x5cbc6d),ctx[_0x2d658f(0x1f8)](_0x4151c4,_0x286aab);}let _0x530ab8=Math[_0x2d658f(0x1d2)](_0x5cbc6d/gridCellSize)*gridCellSize;for(let _0x221d6f=_0x530ab8;_0x221d6f<=_0x286aab;_0x221d6f+=gridCellSize){ctx['moveTo'](_0x2b833d,_0x221d6f),ctx[_0x2d658f(0x1f8)](_0x27c379,_0x221d6f);}ctx[_0x2d658f(0x1d1)](),pixelsCache['forEach'](_0x107489=>{const _0x417677=_0x2d658f;_0x107489[_0x417677(0x22b)]!=='#FFFFFF'&&(ctx[_0x417677(0x250)]=_0x107489['color'],ctx[_0x417677(0x21e)](_0x107489['x'],_0x107489['y'],gridCellSize,gridCellSize));}),ctx[_0x2d658f(0x250)]=_0x2d658f(0x1d6);for(const [_0xb4ff4d,_0x24511c]of markers){ctx[_0x2d658f(0x21e)](_0xb4ff4d,_0x24511c,gridCellSize,gridCellSize);}ctx[_0x2d658f(0x250)]=_0x2d658f(0x1d9),ctx[_0x2d658f(0x21e)](hoverCellX,hoverCellY,gridCellSize,gridCellSize),ctx[_0x2d658f(0x218)](0x1,0x0,0x0,0x1,0x0,0x0);}onSnapshot(collection(db,_0x355fba(0x25a)),_0x3a92ac=>{const _0x28ecfe=_0x355fba;pixelsCache[_0x28ecfe(0x234)](),_0x3a92ac[_0x28ecfe(0x246)](_0x493140=>{const _0x4ea6e5=_0x28ecfe,_0x139f3d=_0x493140['data']();pixelsCache[_0x4ea6e5(0x1c7)](_0x139f3d['x']+'-'+_0x139f3d['y'],_0x139f3d);}),renderAll();}),game[_0x355fba(0x1e9)](_0x355fba(0x242),_0x2c4cee=>{const _0x2d81a7=_0x355fba;(_0x2c4cee[_0x2d81a7(0x1e0)]===0x1||_0x2c4cee[_0x2d81a7(0x1e0)]===0x2||_0x2c4cee[_0x2d81a7(0x1f1)]||_0x2c4cee[_0x2d81a7(0x257)]||_0x2c4cee['metaKey']||_0x2c4cee[_0x2d81a7(0x1bb)])&&(isPanning=!![],lastMouseX=_0x2c4cee[_0x2d81a7(0x248)],lastMouseY=_0x2c4cee[_0x2d81a7(0x251)],_0x2c4cee[_0x2d81a7(0x210)]());}),window[_0x355fba(0x1e9)]('mouseup',()=>{isPanning=![];}),game[_0x355fba(0x1e9)](_0x355fba(0x25c),_0x4ef42a=>_0x4ef42a[_0x355fba(0x210)]()),game[_0x355fba(0x1e9)](_0x355fba(0x1bf),_0x31a54c=>{const _0x1d1ef1=_0x355fba;if(isPanning){const _0x8939b8=_0x31a54c[_0x1d1ef1(0x248)]-lastMouseX,_0x1de2e6=_0x31a54c['clientY']-lastMouseY;camX-=_0x8939b8/scale,camY-=_0x1de2e6/scale,lastMouseX=_0x31a54c[_0x1d1ef1(0x248)],lastMouseY=_0x31a54c[_0x1d1ef1(0x251)],renderAll();}const [_0x265430,_0x313c41]=screenToWorld(_0x31a54c[_0x1d1ef1(0x248)],_0x31a54c[_0x1d1ef1(0x251)]);[hoverCellX,hoverCellY]=snapToGrid(_0x265430,_0x313c41),updateCoordsDisplay(),renderAll();}),game[_0x355fba(0x1e9)](_0x355fba(0x269),_0x1e0472=>{const _0x4c5c89=_0x355fba;_0x1e0472[_0x4c5c89(0x210)]();const _0x411001=1.1,[_0x1990e7,_0x3a9a4e]=screenToWorld(_0x1e0472[_0x4c5c89(0x248)],_0x1e0472['clientY']),_0xcab12=_0x1e0472[_0x4c5c89(0x22c)]<0x0?0x1:-0x1,_0x3b0dd9=clamp(scale*(_0xcab12>0x0?_0x411001:0x1/_0x411001),MIN_SCALE,MAX_SCALE);if(_0x3b0dd9===scale)return;scale=_0x3b0dd9;const _0x16b1d5=game[_0x4c5c89(0x24a)]();camX=_0x1990e7-(_0x1e0472[_0x4c5c89(0x248)]-_0x16b1d5[_0x4c5c89(0x1ff)])/scale,camY=_0x3a9a4e-(_0x1e0472[_0x4c5c89(0x251)]-_0x16b1d5[_0x4c5c89(0x1eb)])/scale;const [_0x126a40,_0x8cb5c2]=screenToWorld(_0x1e0472['clientX'],_0x1e0472[_0x4c5c89(0x251)]);[hoverCellX,hoverCellY]=snapToGrid(_0x126a40,_0x8cb5c2),updateCoordsDisplay(),renderAll();},{'passive':![]});async function placePixelWithHover(){const _0x36e12f=_0x355fba;if(!auth['currentUser'])return alert(_0x36e12f(0x259));if(!canPlace)return;canPlace=![];const _0x42c685=hoverCellX,_0x2e7502=hoverCellY,_0x41f911=doc(db,'pixels',_0x42c685+'-'+_0x2e7502);try{if(currentColor==='#FFFFFF')await deleteDoc(_0x41f911);else await setDoc(_0x41f911,{'x':_0x42c685,'y':_0x2e7502,'color':currentColor});}catch(_0x1d6c76){console['error'](_0x1d6c76);}startReload();}game['addEventListener'](_0x355fba(0x24c),_0x1f3255=>{const _0x5595be=_0x355fba;if(isPanning||_0x1f3255[_0x5595be(0x1e0)]!==0x0)return;placePixelWithHover();});if(cursor)cursor[_0x355fba(0x1d8)][_0x355fba(0x26d)]='none';function _0x5d56(_0x12cee6,_0x4cf3d0){const _0x2ff144=_0x2ff1();return _0x5d56=function(_0x5d5608,_0x99feb2){_0x5d5608=_0x5d5608-0x1bb;let _0x455683=_0x2ff144[_0x5d5608];return _0x455683;},_0x5d56(_0x12cee6,_0x4cf3d0);}function startReload(){const _0x483b5a=_0x355fba;let _0x54c1a4=reloadTime;reloadTimerEl[_0x483b5a(0x204)]='Reload:\x20'+_0x54c1a4+_0x483b5a(0x1e6);const _0x53589d=setInterval(()=>{const _0x546aa0=_0x483b5a;_0x54c1a4--;if(_0x54c1a4<=0x0)clearInterval(_0x53589d),canPlace=!![],reloadTimerEl['innerText']=_0x546aa0(0x1f9);else reloadTimerEl['innerText']=_0x546aa0(0x1d4)+_0x54c1a4+_0x546aa0(0x1e6);},0x3e8);}authButton[_0x355fba(0x1e9)](_0x355fba(0x24c),async()=>{const _0x4c4d89=_0x355fba;if(auth[_0x4c4d89(0x26c)]){await signOut(auth);return;}const _0x433f37=prompt(_0x4c4d89(0x1e3));if(!_0x433f37||_0x433f37!=='1'&&_0x433f37!=='2')return;const _0x14ec9e=prompt(_0x4c4d89(0x1dd)),_0x2a6ba9=prompt(_0x4c4d89(0x211));if(!_0x14ec9e||!_0x2a6ba9)return;try{_0x433f37==='1'?(await signInWithEmailAndPassword(auth,_0x14ec9e,_0x2a6ba9),alert(_0x4c4d89(0x261))):(await createUserWithEmailAndPassword(auth,_0x14ec9e,_0x2a6ba9),alert(_0x4c4d89(0x201)));}catch(_0x10aa21){alert(_0x10aa21[_0x4c4d89(0x260)]);}}),onAuthStateChanged(auth,_0x303ec7=>{const _0x9a49bc=_0x355fba;_0x303ec7?(authButton[_0x9a49bc(0x1fc)]=_0x9a49bc(0x25e),_0x303ec7[_0x9a49bc(0x22f)]===_0x9a49bc(0x21d)?adminPanel[_0x9a49bc(0x1d8)][_0x9a49bc(0x26d)]=_0x9a49bc(0x1ef):adminPanel['style'][_0x9a49bc(0x26d)]='none'):(authButton[_0x9a49bc(0x1fc)]=_0x9a49bc(0x212),adminPanel[_0x9a49bc(0x1d8)]['display']='none');});function parseCoords(){const _0x25154=_0x355fba;markers=[];const _0x475f1e=coordsInput[_0x25154(0x222)][_0x25154(0x1c6)]();if(!_0x475f1e){renderAll();return;}_0x475f1e['split'](',')[_0x25154(0x246)](_0x38b1e0=>{const _0x3eae26=_0x25154,[_0x40762f,_0x463152,_0x4459df,_0x2e1ab2]=_0x38b1e0['trim']()[_0x3eae26(0x238)](/\s+/),_0xdc86f8=parseInt(_0x40762f),_0x21260b=parseInt(_0x463152),_0x43f81c=parseInt(_0x4459df||'1'),_0x2fff27=parseInt(_0x2e1ab2||'1');if(Number[_0x3eae26(0x1c5)](_0xdc86f8)||Number[_0x3eae26(0x1c5)](_0x21260b)||Number[_0x3eae26(0x1c5)](_0x43f81c)||Number[_0x3eae26(0x1c5)](_0x2fff27))return;const _0x3d2190=_0xdc86f8*gridCellSize,_0x47c304=_0x21260b*gridCellSize;for(let _0x1e2538=0x0;_0x1e2538<_0x43f81c;_0x1e2538++){for(let _0x49841d=0x0;_0x49841d<_0x2fff27;_0x49841d++){const _0x162b07=_0x3d2190+_0x1e2538*gridCellSize,_0x105c7a=_0x47c304+_0x49841d*gridCellSize;_0x162b07>=0x0&&_0x105c7a>=0x0&&_0x162b07<=WORLD_W-gridCellSize&&_0x105c7a<=WORLD_H-gridCellSize&&markers[_0x3eae26(0x249)]([_0x162b07,_0x105c7a]);}}}),renderAll();}const upBtn=document[_0x355fba(0x21c)](_0x355fba(0x1c8)),downBtn=document['getElementById'](_0x355fba(0x214)),leftBtn=document[_0x355fba(0x21c)]('leftBtn'),rightBtn=document[_0x355fba(0x21c)](_0x355fba(0x1e1)),zoomInBtn=document[_0x355fba(0x21c)](_0x355fba(0x1cd)),zoomOutBtn=document[_0x355fba(0x21c)](_0x355fba(0x20c)),moveSpeed=0x32,zoomFactorBtn=1.2;function moveCamera(_0x47da50,_0x52a7aa){camX+=_0x47da50/scale,camY+=_0x52a7aa/scale,renderAll();}upBtn['addEventListener'](_0x355fba(0x24c),()=>moveCamera(0x0,-moveSpeed)),downBtn[_0x355fba(0x1e9)]('click',()=>moveCamera(0x0,moveSpeed)),leftBtn[_0x355fba(0x1e9)](_0x355fba(0x24c),()=>moveCamera(-moveSpeed,0x0)),rightBtn['addEventListener'](_0x355fba(0x24c),()=>moveCamera(moveSpeed,0x0)),zoomInBtn[_0x355fba(0x1e9)](_0x355fba(0x24c),()=>{const _0x1e023b=clamp(scale*zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x1e023b,renderAll();}),zoomOutBtn['addEventListener'](_0x355fba(0x24c),()=>{const _0x4a4b6a=clamp(scale/zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x4a4b6a,renderAll();}),coordsInput[_0x355fba(0x1e9)](_0x355fba(0x1e2),parseCoords);async function adminApplyPixels(_0x8e42eb){const _0x5c3262=_0x355fba;if(!auth[_0x5c3262(0x26c)]||auth[_0x5c3262(0x26c)]['email']!==_0x5c3262(0x21d))return alert(_0x5c3262(0x215));parseCoords();let _0x34400a=0x0;for(const [_0x2baca1,_0x5c72ab]of markers){const _0x21f9e1=doc(db,_0x5c3262(0x25a),_0x2baca1+'-'+_0x5c72ab);_0x8e42eb===_0x5c3262(0x23a)?(await setDoc(_0x21f9e1,{'x':_0x2baca1,'y':_0x5c72ab,'color':currentColor}),_0x34400a++):(await deleteDoc(_0x21f9e1),_0x34400a++);}alert((_0x8e42eb===_0x5c3262(0x23a)?_0x5c3262(0x262):_0x5c3262(0x256))+'\x20пикселей:\x20'+_0x34400a);}addPixelBtn['addEventListener'](_0x355fba(0x24c),()=>adminApplyPixels('add')),removePixelBtn[_0x355fba(0x1e9)]('click',()=>adminApplyPixels('remove')),clearAllPixelsBtn[_0x355fba(0x1e9)]('click',async()=>{const _0x40f15c=_0x355fba;if(!auth[_0x40f15c(0x26c)])return alert(_0x40f15c(0x215));const _0x24fd0e=await getDocs(collection(db,_0x40f15c(0x25a)));_0x24fd0e[_0x40f15c(0x246)](_0x1dd7bc=>deleteDoc(_0x1dd7bc[_0x40f15c(0x24f)]));}),banUserBtn[_0x355fba(0x1e9)]('click',()=>{const _0x18d5a9=_0x355fba;if(!auth[_0x18d5a9(0x26c)])return alert(_0x18d5a9(0x215));const _0x436b09=prompt(_0x18d5a9(0x1ee));if(!_0x436b09)return;const _0xcfddff=ref(rtdb,'users/'+_0x436b09);remove(_0xcfddff)[_0x18d5a9(0x25d)](()=>alert(_0x18d5a9(0x1fa)))[_0x18d5a9(0x1d7)](_0x2e76ab=>console[_0x18d5a9(0x21f)](_0x2e76ab));});import{onDisconnect,set}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';function trackOnlinePlayer(){const _0x1ca471=_0x355fba;if(!auth[_0x1ca471(0x26c)])return;const _0x399623=auth[_0x1ca471(0x26c)]['uid'],_0x214504=ref(rtdb,_0x1ca471(0x255)+_0x399623);set(_0x214504,{'email':auth[_0x1ca471(0x26c)][_0x1ca471(0x22f)],'lastSeen':Date[_0x1ca471(0x254)]()}),onDisconnect(_0x214504)[_0x1ca471(0x207)]();}onAuthStateChanged(auth,_0x27abb5=>{_0x27abb5&&trackOnlinePlayer();});function updateOnlinePlayers(){const _0x10c9c4=_0x355fba,_0x323a73=ref(rtdb,_0x10c9c4(0x255));onValue(_0x323a73,_0x3e9daa=>{const _0xc47163=_0x10c9c4,_0x4f43a4=_0x3e9daa[_0xc47163(0x1fb)](),_0x583c0f=_0x4f43a4?Object['keys'](_0x4f43a4)[_0xc47163(0x23c)]:0x0;onlinePlayersEl['innerText']='Online\x20players:\x20'+_0x583c0f;});}updateOnlinePlayers();let lastTouchX=0x0,lastTouchY=0x0,isTouchPanning=![];game['addEventListener'](_0x355fba(0x20f),_0x341587=>{const _0x4b2196=_0x355fba;_0x341587[_0x4b2196(0x219)]['length']===0x1&&(isTouchPanning=!![],lastTouchX=_0x341587['touches'][0x0][_0x4b2196(0x248)],lastTouchY=_0x341587[_0x4b2196(0x219)][0x0][_0x4b2196(0x251)]);}),game[_0x355fba(0x1e9)]('touchmove',_0x494a51=>{const _0x6424ea=_0x355fba;if(isTouchPanning&&_0x494a51[_0x6424ea(0x219)][_0x6424ea(0x23c)]===0x1){const _0x1136c3=_0x494a51[_0x6424ea(0x219)][0x0],_0x2410a8=_0x1136c3['clientX']-lastTouchX,_0x48a758=_0x1136c3[_0x6424ea(0x251)]-lastTouchY;camX-=_0x2410a8/scale,camY-=_0x48a758/scale,lastTouchX=_0x1136c3[_0x6424ea(0x248)],lastTouchY=_0x1136c3[_0x6424ea(0x251)],renderAll();}_0x494a51[_0x6424ea(0x210)]();},{'passive':![]}),game['addEventListener'](_0x355fba(0x1c0),_0x345d6a=>{isTouchPanning=![];});const overlay=document[_0x355fba(0x21c)]('overlayTemplate'),fileInput=document['getElementById'](_0x355fba(0x1c4)),opacityRange=document[_0x355fba(0x21c)](_0x355fba(0x229)),coordX=document[_0x355fba(0x21c)](_0x355fba(0x1d0)),coordY=document['getElementById'](_0x355fba(0x263)),applyCoordsBtn=document[_0x355fba(0x21c)]('applyCoords'),toggleBtn=document[_0x355fba(0x21c)](_0x355fba(0x200));let templateX=0x0,templateY=0x0,templateOpacity=0.5,templateVisible=!![];fileInput[_0x355fba(0x1e9)](_0x355fba(0x23f),_0x1b301d=>{const _0x57b653=_0x355fba,_0xfbd1de=_0x1b301d[_0x57b653(0x244)][_0x57b653(0x23e)][0x0];if(!_0xfbd1de)return;const _0x31f69d=new FileReader();_0x31f69d[_0x57b653(0x1f4)]=_0x4c6461=>{const _0x1c568b=_0x57b653;overlay['src']=_0x4c6461[_0x1c568b(0x244)][_0x1c568b(0x209)],overlay[_0x1c568b(0x1d8)][_0x1c568b(0x26d)]=_0x1c568b(0x1ef);},_0x31f69d[_0x57b653(0x220)](_0xfbd1de);}),opacityRange[_0x355fba(0x1e9)](_0x355fba(0x1e2),()=>{const _0x2fea04=_0x355fba;templateOpacity=opacityRange['value'],overlay[_0x2fea04(0x1d8)][_0x2fea04(0x1fe)]=templateOpacity;}),applyCoordsBtn[_0x355fba(0x1e9)](_0x355fba(0x24c),()=>{const _0x43d35c=_0x355fba;templateX=parseInt(coordX[_0x43d35c(0x222)])||0x0,templateY=parseInt(coordY['value'])||0x0,updateTemplatePosition();}),toggleBtn['addEventListener']('click',()=>{const _0x41fc89=_0x355fba;templateVisible=!templateVisible,overlay[_0x41fc89(0x1d8)][_0x41fc89(0x26d)]=templateVisible?'block':_0x41fc89(0x1bc);});function updateTemplatePosition(){const _0x27d6a0=_0x355fba;overlay[_0x27d6a0(0x1d8)][_0x27d6a0(0x1ca)]='translate('+(-camX*scale+templateX)+_0x27d6a0(0x236)+(-camY*scale+templateY)+_0x27d6a0(0x1ec)+scale+')',overlay[_0x27d6a0(0x1d8)][_0x27d6a0(0x1f5)]='top\x20left';}const oldRenderAll=renderAll;renderAll=function(){const _0x1926f5=_0x355fba;oldRenderAll();if(overlay[_0x1926f5(0x231)])updateTemplatePosition();};
