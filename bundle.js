const _0x3b849e=_0x1e1b;function _0x4cb8(){const _0x3512e8=['clientY','coordX','rgb(136,\x20136,\x20136)','val','rgb(154,\x200,\x200)','clearRect','push','add','style','transform','keys','mousedown','max','paletteToggle','Введите\x20UserID\x20для\x20бана:','opacity','mouseup','authButton','block','floor','3890YDOAYa','#ccc','upBtn','clear','onload','uid','adminPanel','getContext','readAsDataURL','translate(','\x20пикселей:\x20','Come\x20in!','rgba(0,0,0,0.12)','imageSmoothingEnabled','rgb(255,\x20255,\x20255)','px,\x20','rgb(0,\x200,\x20234)','data','drawImage','rgb(0,\x20211,\x20221)','metaKey','touchstart','getElementById','1121679QXqzOu','forEach','isNaN','rgb(160,\x20106,\x2066)','rgb(255,\x2084,\x20178)','set','px)\x20scale(','Login\x20to\x20draw!','leftBtn','ctrlKey','11682penllo','1:461991610382:web:2a5ae293dde4a754c2d45f','removePixelBtn','banUser','Enter\x201\x20to\x20sign\x20in,\x20or\x202\x20to\x20create\x20a\x20new\x20account:','height','teleportInput','email','top\x20left','Удалено','value','rgb(202,\x20227,\x20255)','rgb(25,\x2025,\x20115)','width','88HEnaHK','appendChild','message','AIzaSyCwy4jVn9JIwXuIXVycYAv9EdPGPkgIJvA','innerHTML','min','14064rcOSqS','backgroundColor','1030802raAqsF','logo100153@gmail.com','overlayTemplate','addPixelBtn','zoomInBtn','catch','split','Online\x20players:\x20','1023688NjgALR','fillStyle','reloadTimer','toggleBtn','naturalWidth','mousemove','pixels','addEventListener','createElement','rgb(0,\x20131,\x20199)','getBoundingClientRect','sqrt','div','remove','classList','rgb(130,\x200,\x20128)','110sLNlff','#FFFFFF','selected','users/','Log\x20In','transformOrigin','display','pixellox','colorsChoice','setTransform','complete','touches','src','contextmenu','strokeStyle','game','rgb(228,\x20228,\x20228)','target','pixellox.firebaseapp.com','Reload:\x20','textContent','rgb(0,\x200,\x200)','button','left','lineTo','error','rgb(254,\x20164,\x2096)','rgb(255,\x20101,\x20101)','ceil','#colorsChoice\x20div','preventDefault','top','naturalHeight','Account\x20created!','2981nEnFeE','trim','rgb(78,\x2078,\x2078)','then','result','downBtn','img','length','Только\x20админ!','click','innerText','2wmyrys','input','rgb(96,\x2064,\x2040)','coordsDisplay','Password:','color','\x20\x20Y:\x20','rgb(229,\x200,\x200)','moveTo','rgb(244,\x20179,\x20174)','querySelectorAll','clientX','world.png','rgb(245,\x20223,\x20176)','altKey','shiftKey','currentUser','Добавлено','none','\x20sec','4630137MmsQrP','grid','files','#eef6ff','ref','rgba(255,0,0,0.5)','stroke','coordY','canvas','fillRect','rgb(0,\x20101,\x2019)','Введите\x20корректные\x20координаты\x20X\x20Y','X:\x20','wheel','747530aNchRC','coordsInput','rgb(229,\x20149,\x200)','zoomOutBtn','touchend'];_0x4cb8=function(){return _0x3512e8;};return _0x4cb8();}(function(_0x52f640,_0x234138){const _0x17a996=_0x1e1b,_0x26b81b=_0x52f640();while(!![]){try{const _0x82ca41=parseInt(_0x17a996(0xb4))/0x1*(parseInt(_0x17a996(0xf9))/0x2)+parseInt(_0x17a996(0x10d))/0x3+-parseInt(_0x17a996(0xbc))/0x4+-parseInt(_0x17a996(0x134))/0x5*(-parseInt(_0x17a996(0x9e))/0x6)+-parseInt(_0x17a996(0x11b))/0x7*(parseInt(_0x17a996(0xac))/0x8)+parseInt(_0x17a996(0x94))/0x9*(-parseInt(_0x17a996(0xcc))/0xa)+parseInt(_0x17a996(0xee))/0xb*(-parseInt(_0x17a996(0xb2))/0xc);if(_0x82ca41===_0x234138)break;else _0x26b81b['push'](_0x26b81b['shift']());}catch(_0x4b9bd9){_0x26b81b['push'](_0x26b81b['shift']());}}}(_0x4cb8,0xecc36));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js';import{getFirestore,collection,doc,setDoc,onSnapshot,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js';import{getDatabase,ref,remove}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';import{getAuth,onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js';const firebaseConfig={'apiKey':_0x3b849e(0xaf),'authDomain':_0x3b849e(0xde),'projectId':_0x3b849e(0xd3),'storageBucket':'pixellox.firebasestorage.app','messagingSenderId':'461991610382','appId':_0x3b849e(0x9f)},app=initializeApp(firebaseConfig),db=getFirestore(app),rtdb=getDatabase(app),auth=getAuth(app),coordsDisplayEl=document[_0x3b849e(0x93)](_0x3b849e(0xfc)),colorsChoiceEl=document[_0x3b849e(0x93)](_0x3b849e(0xd4)),paletteToggle=document[_0x3b849e(0x93)](_0x3b849e(0x12d)),game=document[_0x3b849e(0x93)](_0x3b849e(0xdb)),ctx=game[_0x3b849e(0x84)]('2d'),cursor=document[_0x3b849e(0x93)]('cursor'),reloadTimerEl=document['getElementById'](_0x3b849e(0xbe)),adminPanel=document[_0x3b849e(0x93)](_0x3b849e(0x83)),clearAllPixelsBtn=document['getElementById']('clearAllPixels'),banUserBtn=document[_0x3b849e(0x93)](_0x3b849e(0xa1)),authButton=document[_0x3b849e(0x93)](_0x3b849e(0x131)),coordsInput=document['getElementById'](_0x3b849e(0x11c)),addPixelBtn=document[_0x3b849e(0x93)](_0x3b849e(0xb7)),removePixelBtn=document[_0x3b849e(0x93)](_0x3b849e(0xa0)),teleportInput=document[_0x3b849e(0x93)](_0x3b849e(0xa4)),teleportBtn=document[_0x3b849e(0x93)]('teleportBtn');teleportBtn['addEventListener']('click',()=>{const _0x3a9a8e=_0x3b849e;if(!auth[_0x3a9a8e(0x109)]||auth[_0x3a9a8e(0x109)][_0x3a9a8e(0xa5)]!==_0x3a9a8e(0xb5))return alert(_0x3a9a8e(0xf6));const _0x20aabe=teleportInput[_0x3a9a8e(0xa8)]['trim']();if(!_0x20aabe)return;const [_0x56af02,_0x2c16ce]=_0x20aabe[_0x3a9a8e(0xba)](/\s+/),_0x47698d=parseInt(_0x56af02),_0x42f7e1=parseInt(_0x2c16ce);if(Number[_0x3a9a8e(0x96)](_0x47698d)||Number[_0x3a9a8e(0x96)](_0x42f7e1))return alert(_0x3a9a8e(0x118));const _0x12863e=_0x47698d*gridCellSize,_0x2bb912=_0x42f7e1*gridCellSize;camX=_0x12863e-game['width']/0x2/scale,camY=_0x2bb912-game[_0x3a9a8e(0xa3)]/0x2/scale,renderAll();}),ctx[_0x3b849e(0x8a)]=![];const gridCellSize=0xa;game[_0x3b849e(0xab)]=0x4b0,game['height']=0x258;let currentColor='#000000',canPlace=!![];const reloadTime=0x5,colors=[_0x3b849e(0x8b),_0x3b849e(0xfb),_0x3b849e(0xdc),_0x3b849e(0x106),'rgb(196,\x20196,\x20196)','rgb(255,\x20248,\x20137)',_0x3b849e(0x122),'rgb(229,\x20217,\x200)',_0x3b849e(0xf0),'rgb(148,\x20224,\x2068)',_0x3b849e(0xe1),'rgb(2,\x20190,\x201)',_0x3b849e(0x102),'rgb(104,\x20131,\x2056)','rgb(255,\x20167,\x20209)',_0x3b849e(0x117),_0x3b849e(0x98),_0x3b849e(0xa9),_0x3b849e(0xe7),_0x3b849e(0x90),_0x3b849e(0x100),_0x3b849e(0xc5),_0x3b849e(0x124),_0x3b849e(0x8d),_0x3b849e(0xe6),_0x3b849e(0xaa),_0x3b849e(0x11d),'rgb(207,\x20110,\x20228)',_0x3b849e(0x97),_0x3b849e(0xcb)];colorsChoiceEl[_0x3b849e(0xb0)]='',colors['forEach'](_0xc1959b=>{const _0x5be4e6=_0x3b849e,_0x19f2c9=document[_0x5be4e6(0xc4)](_0x5be4e6(0xc8));_0x19f2c9[_0x5be4e6(0x128)][_0x5be4e6(0xb3)]=_0xc1959b,_0x19f2c9[_0x5be4e6(0xc3)]('click',()=>{const _0xf2eca4=_0x5be4e6;currentColor=_0xc1959b,document[_0xf2eca4(0x103)](_0xf2eca4(0xe9))[_0xf2eca4(0x95)](_0x444e4e=>_0x444e4e[_0xf2eca4(0xca)][_0xf2eca4(0xc9)](_0xf2eca4(0xce))),_0x19f2c9[_0xf2eca4(0xca)][_0xf2eca4(0x127)]('selected');}),colorsChoiceEl[_0x5be4e6(0xad)](_0x19f2c9);});const colorsChoice=document['getElementById'](_0x3b849e(0xd4)),togglePalette=document['getElementById']('togglePalette');togglePalette[_0x3b849e(0xc3)]('click',()=>{const _0x1a75a2=_0x3b849e;colorsChoice[_0x1a75a2(0x128)][_0x1a75a2(0xd2)]===_0x1a75a2(0x10b)?colorsChoice[_0x1a75a2(0x128)][_0x1a75a2(0xd2)]=_0x1a75a2(0x10e):colorsChoice[_0x1a75a2(0x128)][_0x1a75a2(0xd2)]='none';});const worldMap=new Image();worldMap[_0x3b849e(0xd8)]=_0x3b849e(0x105);const SCALE_TILE=0x32;let WORLD_W=0x4e20*SCALE_TILE,WORLD_H=0x4e20*SCALE_TILE,camX=0x0,camY=0x0,scale=0x1;const MIN_SCALE=0.005,MAX_SCALE=0x6;let isPanning=![],lastMouseX=0x0,lastMouseY=0x0;function clamp(_0x32df71,_0x45fbad,_0xf2b238){const _0x5d9aea=_0x3b849e;return Math[_0x5d9aea(0x12c)](_0x45fbad,Math[_0x5d9aea(0xb1)](_0xf2b238,_0x32df71));}function screenToWorld(_0x37e15a,_0x4c8cd3){const _0x16d1d9=_0x3b849e,_0x5cf46e=game[_0x16d1d9(0xc6)](),_0x4db120=(_0x37e15a-_0x5cf46e[_0x16d1d9(0xe3)])/scale+camX,_0x1a4b72=(_0x4c8cd3-_0x5cf46e['top'])/scale+camY;return[_0x4db120,_0x1a4b72];}function snapToGrid(_0x25aa9e,_0x1edd81){const _0x2dbd02=_0x3b849e;return[Math[_0x2dbd02(0x133)](_0x25aa9e/gridCellSize)*gridCellSize,Math[_0x2dbd02(0x133)](_0x1edd81/gridCellSize)*gridCellSize];}function _0x1e1b(_0x29071d,_0x495d97){const _0x4cb848=_0x4cb8();return _0x1e1b=function(_0x1e1b5b,_0x3a3733){_0x1e1b5b=_0x1e1b5b-0x7f;let _0x1a3e17=_0x4cb848[_0x1e1b5b];return _0x1a3e17;},_0x1e1b(_0x29071d,_0x495d97);}let hoverCellX=0x0,hoverCellY=0x0;const pixelsCache=new Map();let markers=[];function updateCoordsDisplay(){const _0x37ff70=_0x3b849e;if(!coordsDisplayEl)return;const _0x50eb17=Math[_0x37ff70(0x133)](hoverCellX/gridCellSize),_0x365023=Math[_0x37ff70(0x133)](hoverCellY/gridCellSize);coordsDisplayEl['textContent']=_0x37ff70(0x119)+_0x50eb17+_0x37ff70(0xff)+_0x365023;}const TILE_SIZE=0x3e8;let tiles=[];const offscreenCanvas=document[_0x3b849e(0xc4)](_0x3b849e(0x115));offscreenCanvas['width']=TILE_SIZE,offscreenCanvas[_0x3b849e(0xa3)]=TILE_SIZE;const offCtx=offscreenCanvas['getContext']('2d',{'willReadFrequently':!![]});offCtx['imageSmoothingEnabled']=![],worldMap[_0x3b849e(0x81)]=()=>{const _0x2314a6=_0x3b849e,_0x40ec08=worldMap[_0x2314a6(0xc0)]||0x4e20,_0x3e1644=worldMap[_0x2314a6(0xec)]||0x4e20;WORLD_W=_0x40ec08*SCALE_TILE,WORLD_H=_0x3e1644*SCALE_TILE;const _0x435fff=Math[_0x2314a6(0xe8)](_0x40ec08/TILE_SIZE),_0x5b36eb=Math['ceil'](_0x3e1644/TILE_SIZE);tiles=[];for(let _0x1ebad1=0x0;_0x1ebad1<_0x435fff;_0x1ebad1++){for(let _0x520564=0x0;_0x520564<_0x5b36eb;_0x520564++){const _0x4e3372=_0x1ebad1*TILE_SIZE,_0x4b3443=_0x520564*TILE_SIZE,_0x18ce87=Math[_0x2314a6(0xb1)](TILE_SIZE,_0x40ec08-_0x4e3372),_0x2f0c28=Math[_0x2314a6(0xb1)](TILE_SIZE,_0x3e1644-_0x4b3443);offCtx[_0x2314a6(0x125)](0x0,0x0,TILE_SIZE,TILE_SIZE),offCtx['drawImage'](worldMap,_0x4e3372,_0x4b3443,_0x18ce87,_0x2f0c28,0x0,0x0,_0x18ce87,_0x2f0c28);const _0x397d11=new Image();_0x397d11[_0x2314a6(0xd8)]=offscreenCanvas['toDataURL']('image/png');const _0x11c2a5=_0x4e3372*SCALE_TILE,_0x35026a=_0x4b3443*SCALE_TILE,_0x5b5433=_0x18ce87*SCALE_TILE,_0x22bf92=_0x2f0c28*SCALE_TILE;tiles['push']({'img':_0x397d11,'dx':_0x11c2a5,'dy':_0x35026a,'dw':_0x5b5433,'dh':_0x22bf92});}}renderAll();};function renderAll(){const _0x25c9b9=_0x3b849e;ctx[_0x25c9b9(0x8a)]=![],ctx[_0x25c9b9(0xd5)](0x1,0x0,0x0,0x1,0x0,0x0),ctx[_0x25c9b9(0x125)](0x0,0x0,game[_0x25c9b9(0xab)],game[_0x25c9b9(0xa3)]),ctx[_0x25c9b9(0xd5)](scale,0x0,0x0,scale,-camX*scale,-camY*scale);const _0x1fabfb=camX,_0x3a8ba2=camY,_0x57695c=camX+game[_0x25c9b9(0xab)]/scale,_0x51dc80=camY+game[_0x25c9b9(0xa3)]/scale;for(const _0x45a582 of tiles){if(_0x45a582['dx']+_0x45a582['dw']<_0x1fabfb||_0x45a582['dx']>_0x57695c||_0x45a582['dy']+_0x45a582['dh']<_0x3a8ba2||_0x45a582['dy']>_0x51dc80)continue;_0x45a582[_0x25c9b9(0xf4)][_0x25c9b9(0xd6)]&&_0x45a582[_0x25c9b9(0xf4)][_0x25c9b9(0xc0)]?ctx[_0x25c9b9(0x8f)](_0x45a582[_0x25c9b9(0xf4)],_0x45a582['dx'],_0x45a582['dy'],_0x45a582['dw'],_0x45a582['dh']):(ctx[_0x25c9b9(0xbd)]=_0x25c9b9(0x110),ctx[_0x25c9b9(0x116)](_0x45a582['dx'],_0x45a582['dy'],_0x45a582['dw'],_0x45a582['dh']));}ctx['beginPath'](),ctx[_0x25c9b9(0xda)]=_0x25c9b9(0x135);let _0x56f3ab=Math[_0x25c9b9(0x133)](_0x1fabfb/gridCellSize)*gridCellSize;for(let _0xf6bb2b=_0x56f3ab;_0xf6bb2b<=_0x57695c;_0xf6bb2b+=gridCellSize){ctx[_0x25c9b9(0x101)](_0xf6bb2b,_0x3a8ba2),ctx['lineTo'](_0xf6bb2b,_0x51dc80);}let _0x58f915=Math[_0x25c9b9(0x133)](_0x3a8ba2/gridCellSize)*gridCellSize;for(let _0x10ac37=_0x58f915;_0x10ac37<=_0x51dc80;_0x10ac37+=gridCellSize){ctx['moveTo'](_0x1fabfb,_0x10ac37),ctx[_0x25c9b9(0xe4)](_0x57695c,_0x10ac37);}ctx[_0x25c9b9(0x113)](),pixelsCache[_0x25c9b9(0x95)](_0x4db970=>{const _0x3fe99c=_0x25c9b9;_0x4db970[_0x3fe99c(0xfe)]!==_0x3fe99c(0xcd)&&(ctx[_0x3fe99c(0xbd)]=_0x4db970[_0x3fe99c(0xfe)],ctx[_0x3fe99c(0x116)](_0x4db970['x'],_0x4db970['y'],gridCellSize,gridCellSize));}),ctx[_0x25c9b9(0xbd)]=_0x25c9b9(0x112);for(const [_0x3fa7d4,_0x490e18]of markers){ctx[_0x25c9b9(0x116)](_0x3fa7d4,_0x490e18,gridCellSize,gridCellSize);}ctx['fillStyle']=_0x25c9b9(0x89),ctx[_0x25c9b9(0x116)](hoverCellX,hoverCellY,gridCellSize,gridCellSize),ctx[_0x25c9b9(0xd5)](0x1,0x0,0x0,0x1,0x0,0x0);}onSnapshot(collection(db,_0x3b849e(0xc2)),_0x289c2e=>{const _0x4467a2=_0x3b849e;pixelsCache[_0x4467a2(0x80)](),_0x289c2e[_0x4467a2(0x95)](_0x4862f9=>{const _0x341ba9=_0x4467a2,_0x1814a2=_0x4862f9[_0x341ba9(0x8e)]();pixelsCache[_0x341ba9(0x99)](_0x1814a2['x']+'-'+_0x1814a2['y'],_0x1814a2);}),renderAll();}),game['addEventListener'](_0x3b849e(0x12b),_0x3862ff=>{const _0x4edee8=_0x3b849e;(_0x3862ff[_0x4edee8(0xe2)]===0x1||_0x3862ff[_0x4edee8(0xe2)]===0x2||_0x3862ff[_0x4edee8(0x108)]||_0x3862ff[_0x4edee8(0x9d)]||_0x3862ff[_0x4edee8(0x91)]||_0x3862ff[_0x4edee8(0x107)])&&(isPanning=!![],lastMouseX=_0x3862ff[_0x4edee8(0x104)],lastMouseY=_0x3862ff[_0x4edee8(0x120)],_0x3862ff[_0x4edee8(0xea)]());}),window[_0x3b849e(0xc3)](_0x3b849e(0x130),()=>{isPanning=![];}),game[_0x3b849e(0xc3)](_0x3b849e(0xd9),_0x14598f=>_0x14598f['preventDefault']()),game[_0x3b849e(0xc3)](_0x3b849e(0xc1),_0x58db88=>{const _0x37ab00=_0x3b849e;if(isPanning){const _0x387fb6=_0x58db88[_0x37ab00(0x104)]-lastMouseX,_0x3062c1=_0x58db88[_0x37ab00(0x120)]-lastMouseY;camX-=_0x387fb6/scale,camY-=_0x3062c1/scale,lastMouseX=_0x58db88[_0x37ab00(0x104)],lastMouseY=_0x58db88[_0x37ab00(0x120)],renderAll();}const [_0x4b6115,_0x2f353d]=screenToWorld(_0x58db88[_0x37ab00(0x104)],_0x58db88[_0x37ab00(0x120)]);[hoverCellX,hoverCellY]=snapToGrid(_0x4b6115,_0x2f353d),updateCoordsDisplay(),renderAll();}),game['addEventListener'](_0x3b849e(0x11a),_0x47dbba=>{const _0x530a8c=_0x3b849e;_0x47dbba['preventDefault']();const _0x25b43f=1.1,[_0x4263d0,_0x4620bc]=screenToWorld(_0x47dbba[_0x530a8c(0x104)],_0x47dbba[_0x530a8c(0x120)]),_0x1d64d8=_0x47dbba['deltaY']<0x0?0x1:-0x1,_0x131853=clamp(scale*(_0x1d64d8>0x0?_0x25b43f:0x1/_0x25b43f),MIN_SCALE,MAX_SCALE);if(_0x131853===scale)return;scale=_0x131853;const _0xa0df4e=game[_0x530a8c(0xc6)]();camX=_0x4263d0-(_0x47dbba[_0x530a8c(0x104)]-_0xa0df4e[_0x530a8c(0xe3)])/scale,camY=_0x4620bc-(_0x47dbba[_0x530a8c(0x120)]-_0xa0df4e[_0x530a8c(0xeb)])/scale;const [_0x1ab150,_0x2df8f5]=screenToWorld(_0x47dbba['clientX'],_0x47dbba[_0x530a8c(0x120)]);[hoverCellX,hoverCellY]=snapToGrid(_0x1ab150,_0x2df8f5),updateCoordsDisplay(),renderAll();},{'passive':![]});async function placePixelWithHover(){const _0x1aaf14=_0x3b849e;if(!auth[_0x1aaf14(0x109)])return alert(_0x1aaf14(0x9b));if(!canPlace)return;canPlace=![];const _0x31c5eb=hoverCellX,_0x33777d=hoverCellY,_0x885452=doc(db,_0x1aaf14(0xc2),_0x31c5eb+'-'+_0x33777d);try{if(currentColor===_0x1aaf14(0xcd))await deleteDoc(_0x885452);else await setDoc(_0x885452,{'x':_0x31c5eb,'y':_0x33777d,'color':currentColor});}catch(_0x1b8141){console[_0x1aaf14(0xe5)](_0x1b8141);}startReload();}game[_0x3b849e(0xc3)](_0x3b849e(0xf7),_0x35e7c5=>{const _0x40e90e=_0x3b849e;if(isPanning||_0x35e7c5[_0x40e90e(0xe2)]!==0x0)return;placePixelWithHover();});if(cursor)cursor[_0x3b849e(0x128)][_0x3b849e(0xd2)]=_0x3b849e(0x10b);function startReload(){const _0x457ee1=_0x3b849e;let _0x5aea9c=reloadTime;reloadTimerEl[_0x457ee1(0xf8)]='Reload:\x20'+_0x5aea9c+'\x20sec';const _0x1128fb=setInterval(()=>{const _0x826012=_0x457ee1;_0x5aea9c--;if(_0x5aea9c<=0x0)clearInterval(_0x1128fb),canPlace=!![],reloadTimerEl[_0x826012(0xf8)]='Ready!';else reloadTimerEl['innerText']=_0x826012(0xdf)+_0x5aea9c+_0x826012(0x10c);},0x3e8);}authButton[_0x3b849e(0xc3)](_0x3b849e(0xf7),async()=>{const _0x25c9c3=_0x3b849e;if(auth[_0x25c9c3(0x109)]){await signOut(auth);return;}const _0x3e0f13=prompt(_0x25c9c3(0xa2));if(!_0x3e0f13||_0x3e0f13!=='1'&&_0x3e0f13!=='2')return;const _0x170789=prompt('Email:'),_0x293d56=prompt(_0x25c9c3(0xfd));if(!_0x170789||!_0x293d56)return;try{_0x3e0f13==='1'?(await signInWithEmailAndPassword(auth,_0x170789,_0x293d56),alert(_0x25c9c3(0x88))):(await createUserWithEmailAndPassword(auth,_0x170789,_0x293d56),alert(_0x25c9c3(0xed)));}catch(_0x2122e5){alert(_0x2122e5[_0x25c9c3(0xae)]);}}),onAuthStateChanged(auth,_0x21e40b=>{const _0x57c227=_0x3b849e;_0x21e40b?(authButton['textContent']='Log\x20Out',_0x21e40b[_0x57c227(0xa5)]===_0x57c227(0xb5)?adminPanel[_0x57c227(0x128)]['display']=_0x57c227(0x132):adminPanel['style'][_0x57c227(0xd2)]=_0x57c227(0x10b)):(authButton[_0x57c227(0xe0)]=_0x57c227(0xd0),adminPanel[_0x57c227(0x128)][_0x57c227(0xd2)]=_0x57c227(0x10b));});function parseCoords(){const _0x5ed1ef=_0x3b849e;markers=[];const _0x7b24ae=coordsInput['value'][_0x5ed1ef(0xef)]();if(!_0x7b24ae){renderAll();return;}_0x7b24ae[_0x5ed1ef(0xba)](',')['forEach'](_0x3473de=>{const _0x5afdb5=_0x5ed1ef,[_0xe1b346,_0x12037f,_0x37cd8,_0x40c6d5]=_0x3473de['trim']()['split'](/\s+/),_0x4430f1=parseInt(_0xe1b346),_0x71ed9e=parseInt(_0x12037f),_0x5c922a=parseInt(_0x37cd8||'1'),_0x423731=parseInt(_0x40c6d5||'1');if(Number['isNaN'](_0x4430f1)||Number['isNaN'](_0x71ed9e)||Number[_0x5afdb5(0x96)](_0x5c922a)||Number[_0x5afdb5(0x96)](_0x423731))return;const _0x578227=_0x4430f1*gridCellSize,_0x318b00=_0x71ed9e*gridCellSize;for(let _0x225fe1=0x0;_0x225fe1<_0x5c922a;_0x225fe1++){for(let _0xbd356f=0x0;_0xbd356f<_0x423731;_0xbd356f++){const _0x42255e=_0x578227+_0x225fe1*gridCellSize,_0x2061ca=_0x318b00+_0xbd356f*gridCellSize;_0x42255e>=0x0&&_0x2061ca>=0x0&&_0x42255e<=WORLD_W-gridCellSize&&_0x2061ca<=WORLD_H-gridCellSize&&markers[_0x5afdb5(0x126)]([_0x42255e,_0x2061ca]);}}}),renderAll();}const upBtn=document[_0x3b849e(0x93)](_0x3b849e(0x7f)),downBtn=document[_0x3b849e(0x93)](_0x3b849e(0xf3)),leftBtn=document[_0x3b849e(0x93)](_0x3b849e(0x9c)),rightBtn=document[_0x3b849e(0x93)]('rightBtn'),zoomInBtn=document[_0x3b849e(0x93)](_0x3b849e(0xb8)),zoomOutBtn=document[_0x3b849e(0x93)](_0x3b849e(0x11e)),moveSpeed=0x32,zoomFactorBtn=1.2;function moveCamera(_0x38e165,_0x334460){camX+=_0x38e165/scale,camY+=_0x334460/scale,renderAll();}upBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>moveCamera(0x0,-moveSpeed)),downBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>moveCamera(0x0,moveSpeed)),leftBtn['addEventListener'](_0x3b849e(0xf7),()=>moveCamera(-moveSpeed,0x0)),rightBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>moveCamera(moveSpeed,0x0)),zoomInBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>{const _0x57b6fd=clamp(scale*zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x57b6fd,renderAll();}),zoomOutBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>{const _0x273683=clamp(scale/zoomFactorBtn,MIN_SCALE,MAX_SCALE);scale=_0x273683,renderAll();}),coordsInput[_0x3b849e(0xc3)](_0x3b849e(0xfa),parseCoords);async function adminApplyPixels(_0x545db2){const _0x5161de=_0x3b849e;if(!auth[_0x5161de(0x109)]||auth[_0x5161de(0x109)][_0x5161de(0xa5)]!==_0x5161de(0xb5))return alert('Только\x20админ!');parseCoords();let _0x273fb4=0x0;for(const [_0x6c962f,_0x54a2b2]of markers){const _0x6924e6=doc(db,'pixels',_0x6c962f+'-'+_0x54a2b2);_0x545db2===_0x5161de(0x127)?(await setDoc(_0x6924e6,{'x':_0x6c962f,'y':_0x54a2b2,'color':currentColor}),_0x273fb4++):(await deleteDoc(_0x6924e6),_0x273fb4++);}alert((_0x545db2==='add'?_0x5161de(0x10a):_0x5161de(0xa7))+_0x5161de(0x87)+_0x273fb4);}addPixelBtn[_0x3b849e(0xc3)]('click',()=>adminApplyPixels(_0x3b849e(0x127))),removePixelBtn['addEventListener']('click',()=>adminApplyPixels(_0x3b849e(0xc9))),clearAllPixelsBtn[_0x3b849e(0xc3)]('click',async()=>{const _0x57f474=_0x3b849e;if(!auth[_0x57f474(0x109)])return alert(_0x57f474(0xf6));const _0x30a33d=await getDocs(collection(db,'pixels'));_0x30a33d[_0x57f474(0x95)](_0x52e13f=>deleteDoc(_0x52e13f[_0x57f474(0x111)]));}),banUserBtn[_0x3b849e(0xc3)](_0x3b849e(0xf7),()=>{const _0x51d08d=_0x3b849e;if(!auth[_0x51d08d(0x109)])return alert(_0x51d08d(0xf6));const _0x181f16=prompt(_0x51d08d(0x12e));if(!_0x181f16)return;const _0x181689=ref(rtdb,_0x51d08d(0xcf)+_0x181f16);remove(_0x181689)[_0x51d08d(0xf1)](()=>alert('Пользователь\x20забанен!'))[_0x51d08d(0xb9)](_0x35a10f=>console[_0x51d08d(0xe5)](_0x35a10f));});import{onDisconnect,set}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';function trackOnlinePlayer(){const _0x272da7=_0x3b849e;if(!auth[_0x272da7(0x109)])return;const _0x4dc912=auth[_0x272da7(0x109)][_0x272da7(0x82)],_0xdefbd4=ref(rtdb,_0x272da7(0xcf)+_0x4dc912);set(_0xdefbd4,{'email':auth[_0x272da7(0x109)][_0x272da7(0xa5)],'lastSeen':Date['now']()}),onDisconnect(_0xdefbd4)[_0x272da7(0xc9)]();}onAuthStateChanged(auth,_0x45d36d=>{_0x45d36d&&trackOnlinePlayer();});function updateOnlinePlayers(){const _0x218f5=_0x3b849e,_0x57bf3d=ref(rtdb,_0x218f5(0xcf));onValue(_0x57bf3d,_0x519ace=>{const _0x467e1d=_0x218f5,_0x5d62c5=_0x519ace[_0x467e1d(0x123)](),_0xbe390=_0x5d62c5?Object[_0x467e1d(0x12a)](_0x5d62c5)[_0x467e1d(0xf5)]:0x0;onlinePlayersEl[_0x467e1d(0xf8)]=_0x467e1d(0xbb)+_0xbe390;});}updateOnlinePlayers();let isTouchPanning=![],lastTouchX=0x0,lastTouchY=0x0,lastDist=0x0;function getDistance(_0x114de6,_0x47d50c){const _0x928847=_0x3b849e,_0x5a8596=_0x114de6['clientX']-_0x47d50c['clientX'],_0x5645e9=_0x114de6['clientY']-_0x47d50c[_0x928847(0x120)];return Math[_0x928847(0xc7)](_0x5a8596*_0x5a8596+_0x5645e9*_0x5645e9);}game['addEventListener'](_0x3b849e(0x92),_0x3c7c76=>{const _0x5f0d27=_0x3b849e;if(_0x3c7c76[_0x5f0d27(0xd7)][_0x5f0d27(0xf5)]===0x1)isTouchPanning=!![],lastTouchX=_0x3c7c76['touches'][0x0][_0x5f0d27(0x104)],lastTouchY=_0x3c7c76['touches'][0x0]['clientY'];else _0x3c7c76['touches'][_0x5f0d27(0xf5)]===0x2&&(isTouchPanning=![],lastDist=getDistance(_0x3c7c76[_0x5f0d27(0xd7)][0x0],_0x3c7c76[_0x5f0d27(0xd7)][0x1]));_0x3c7c76['preventDefault']();},{'passive':![]}),game['addEventListener']('touchmove',_0x3051ce=>{const _0x14b469=_0x3b849e;if(_0x3051ce['touches'][_0x14b469(0xf5)]===0x1&&isTouchPanning){const _0x38802f=(_0x3051ce[_0x14b469(0xd7)][0x0][_0x14b469(0x104)]-lastTouchX)/scale,_0x1efd2c=(_0x3051ce[_0x14b469(0xd7)][0x0][_0x14b469(0x120)]-lastTouchY)/scale;camX-=_0x38802f,camY-=_0x1efd2c,lastTouchX=_0x3051ce['touches'][0x0][_0x14b469(0x104)],lastTouchY=_0x3051ce[_0x14b469(0xd7)][0x0][_0x14b469(0x120)],renderAll();}else{if(_0x3051ce[_0x14b469(0xd7)]['length']===0x2){const _0x58b5dc=getDistance(_0x3051ce[_0x14b469(0xd7)][0x0],_0x3051ce[_0x14b469(0xd7)][0x1]);if(lastDist>0x0){const _0x149b07=_0x58b5dc/lastDist,_0x2e5d88=(_0x3051ce[_0x14b469(0xd7)][0x0][_0x14b469(0x104)]+_0x3051ce[_0x14b469(0xd7)][0x1][_0x14b469(0x104)])/0x2,_0x3470b8=(_0x3051ce[_0x14b469(0xd7)][0x0][_0x14b469(0x120)]+_0x3051ce[_0x14b469(0xd7)][0x1][_0x14b469(0x120)])/0x2,[_0x453ab3,_0x2601d0]=screenToWorld(_0x2e5d88,_0x3470b8);scale=clamp(scale*_0x149b07,MIN_SCALE,MAX_SCALE);const _0x12176f=game['getBoundingClientRect']();camX=_0x453ab3-(_0x2e5d88-_0x12176f[_0x14b469(0xe3)])/scale,camY=_0x2601d0-(_0x3470b8-_0x12176f[_0x14b469(0xeb)])/scale,renderAll();}lastDist=_0x58b5dc;}}_0x3051ce[_0x14b469(0xea)]();},{'passive':![]}),game[_0x3b849e(0xc3)](_0x3b849e(0x11f),_0x2facf9=>{const _0x1945ff=_0x3b849e;_0x2facf9[_0x1945ff(0xd7)][_0x1945ff(0xf5)]<0x2&&(lastDist=0x0),_0x2facf9[_0x1945ff(0xd7)]['length']===0x0&&(isTouchPanning=![]),_0x2facf9['preventDefault']();},{'passive':![]});const overlay=document[_0x3b849e(0x93)](_0x3b849e(0xb6)),fileInput=document[_0x3b849e(0x93)]('templateFile'),opacityRange=document[_0x3b849e(0x93)]('opacityRange'),coordX=document[_0x3b849e(0x93)](_0x3b849e(0x121)),coordY=document['getElementById'](_0x3b849e(0x114)),applyCoordsBtn=document['getElementById']('applyCoords'),toggleBtn=document['getElementById'](_0x3b849e(0xbf));let templateX=0x0,templateY=0x0,templateOpacity=0.5,templateVisible=!![];fileInput['addEventListener']('change',_0x2990fa=>{const _0x5432ad=_0x3b849e,_0xc4569=_0x2990fa['target'][_0x5432ad(0x10f)][0x0];if(!_0xc4569)return;const _0x53f32f=new FileReader();_0x53f32f['onload']=_0x29eb2a=>{const _0x179d3d=_0x5432ad;overlay[_0x179d3d(0xd8)]=_0x29eb2a[_0x179d3d(0xdd)][_0x179d3d(0xf2)],overlay['style'][_0x179d3d(0xd2)]=_0x179d3d(0x132);},_0x53f32f[_0x5432ad(0x85)](_0xc4569);}),opacityRange[_0x3b849e(0xc3)](_0x3b849e(0xfa),()=>{const _0x1d34d1=_0x3b849e;templateOpacity=opacityRange['value'],overlay[_0x1d34d1(0x128)][_0x1d34d1(0x12f)]=templateOpacity;}),applyCoordsBtn['addEventListener']('click',()=>{templateX=parseInt(coordX['value'])||0x0,templateY=parseInt(coordY['value'])||0x0,updateTemplatePosition();}),toggleBtn['addEventListener']('click',()=>{const _0x13e0d1=_0x3b849e;templateVisible=!templateVisible,overlay['style'][_0x13e0d1(0xd2)]=templateVisible?_0x13e0d1(0x132):_0x13e0d1(0x10b);});function updateTemplatePosition(){const _0x1332f1=_0x3b849e;overlay[_0x1332f1(0x128)][_0x1332f1(0x129)]=_0x1332f1(0x86)+(-camX*scale+templateX)+_0x1332f1(0x8c)+(-camY*scale+templateY)+_0x1332f1(0x9a)+scale+')',overlay[_0x1332f1(0x128)][_0x1332f1(0xd1)]=_0x1332f1(0xa6);}const oldRenderAll=renderAll;renderAll=function(){oldRenderAll();if(overlay['src'])updateTemplatePosition();};
