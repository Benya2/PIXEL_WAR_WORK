const _0x1aed46=_0x57a1;(function(_0xe16ea8,_0x5665e7){const _0x3055ed=_0x57a1,_0xf501b8=_0xe16ea8();while(!![]){try{const _0x94643a=parseInt(_0x3055ed(0x155))/0x1+parseInt(_0x3055ed(0x16a))/0x2+-parseInt(_0x3055ed(0x14c))/0x3+-parseInt(_0x3055ed(0x181))/0x4+parseInt(_0x3055ed(0x13f))/0x5+parseInt(_0x3055ed(0x14a))/0x6*(parseInt(_0x3055ed(0x17a))/0x7)+parseInt(_0x3055ed(0x149))/0x8;if(_0x94643a===_0x5665e7)break;else _0xf501b8['push'](_0xf501b8['shift']());}catch(_0x7932df){_0xf501b8['push'](_0xf501b8['shift']());}}}(_0x130c,0xdd8e1));import{initializeApp}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js';import{getFirestore,collection,doc,setDoc,onSnapshot,deleteDoc,getDocs}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js';import{getDatabase,ref,remove}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';import{getAuth,onAuthStateChanged,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js';const firebaseConfig={'apiKey':_0x1aed46(0x14b),'authDomain':_0x1aed46(0x159),'projectId':'pixellox','storageBucket':'pixellox.firebasestorage.app','messagingSenderId':_0x1aed46(0x15e),'appId':_0x1aed46(0x1b1)},app=initializeApp(firebaseConfig),db=getFirestore(app),rtdb=getDatabase(app),auth=getAuth(app),coordsDisplayEl=document['getElementById']('coordsDisplay'),colorsChoiceEl=document['getElementById']('colorsChoice'),paletteToggle=document[_0x1aed46(0x128)](_0x1aed46(0x172)),game=document[_0x1aed46(0x128)](_0x1aed46(0x1ae)),ctx=game['getContext']('2d'),cursor=document[_0x1aed46(0x128)]('cursor'),reloadTimerEl=document[_0x1aed46(0x128)](_0x1aed46(0x18c)),adminPanel=document[_0x1aed46(0x128)](_0x1aed46(0x124)),clearAllPixelsBtn=document[_0x1aed46(0x128)](_0x1aed46(0x179)),banUserBtn=document['getElementById'](_0x1aed46(0x19d)),authButton=document[_0x1aed46(0x128)]('authButton'),coordsInput=document[_0x1aed46(0x128)](_0x1aed46(0x17e)),addPixelBtn=document[_0x1aed46(0x128)](_0x1aed46(0x187)),removePixelBtn=document[_0x1aed46(0x128)](_0x1aed46(0x136)),teleportInput=document[_0x1aed46(0x128)](_0x1aed46(0x160)),teleportBtn=document[_0x1aed46(0x128)](_0x1aed46(0x192));teleportBtn[_0x1aed46(0x147)](_0x1aed46(0x148),()=>{const _0x12635f=_0x1aed46;if(!auth[_0x12635f(0x130)]||auth[_0x12635f(0x130)][_0x12635f(0x18a)]!==_0x12635f(0x1ac))return alert(_0x12635f(0x190));const _0x13aaf4=teleportInput['value'][_0x12635f(0x1aa)]();if(!_0x13aaf4)return;const [_0xf4294f,_0x15c7bf]=_0x13aaf4[_0x12635f(0x1a7)](/\s+/),_0x366f68=parseInt(_0xf4294f),_0x1a5f64=parseInt(_0x15c7bf);if(Number[_0x12635f(0x131)](_0x366f68)||Number['isNaN'](_0x1a5f64))return alert(_0x12635f(0x1af));const _0x35cfb8=_0x366f68*gridCellSize,_0x266289=_0x1a5f64*gridCellSize;camX=_0x35cfb8-game['width']/0x2/scale,camY=_0x266289-game[_0x12635f(0x166)]/0x2/scale,renderAll();}),ctx[_0x1aed46(0x178)]=![];const gridCellSize=0xa;game[_0x1aed46(0x198)]=0x4b0,game['height']=0x258;let currentColor='#000000',canPlace=!![];const reloadTime=0x5,colors=['rgb(255,\x20255,\x20255)',_0x1aed46(0x167),_0x1aed46(0x13c),_0x1aed46(0x1ad),_0x1aed46(0x1a8),_0x1aed46(0x199),_0x1aed46(0x188),_0x1aed46(0x13b),'rgb(78,\x2078,\x2078)','rgb(148,\x20224,\x2068)',_0x1aed46(0x182),'rgb(2,\x20190,\x201)',_0x1aed46(0x12f),_0x1aed46(0x168),_0x1aed46(0x13a),'rgb(0,\x20101,\x2019)',_0x1aed46(0x177),'rgb(202,\x20227,\x20255)',_0x1aed46(0x19a),_0x1aed46(0x16c),'rgb(229,\x200,\x200)',_0x1aed46(0x16b),_0x1aed46(0x18b),_0x1aed46(0x163),_0x1aed46(0x145),_0x1aed46(0x17c),'rgb(229,\x20149,\x200)','rgb(207,\x20110,\x20228)',_0x1aed46(0x15f),_0x1aed46(0x170)];colorsChoiceEl['innerHTML']='',colors['forEach'](_0x291669=>{const _0x47107c=_0x1aed46,_0x30297f=document['createElement']('div');_0x30297f[_0x47107c(0x194)][_0x47107c(0x176)]=_0x291669,_0x30297f['addEventListener']('click',()=>{const _0x2931b8=_0x47107c;currentColor=_0x291669,document['querySelectorAll']('#colorsChoice\x20div')['forEach'](_0x3aded6=>_0x3aded6[_0x2931b8(0x126)][_0x2931b8(0x180)](_0x2931b8(0x12a))),_0x30297f[_0x2931b8(0x126)]['add'](_0x2931b8(0x12a));}),colorsChoiceEl[_0x47107c(0x164)](_0x30297f);});const colorsChoice=document[_0x1aed46(0x128)](_0x1aed46(0x1a1)),togglePalette=document['getElementById'](_0x1aed46(0x14f));togglePalette[_0x1aed46(0x147)]('click',()=>{const _0x4dd4f3=_0x1aed46;colorsChoice['style']['display']===_0x4dd4f3(0x1b2)?colorsChoice[_0x4dd4f3(0x194)][_0x4dd4f3(0x196)]=_0x4dd4f3(0x133):colorsChoice[_0x4dd4f3(0x194)]['display']=_0x4dd4f3(0x1b2);});const worldMap=new Image();function _0x130c(){const _0x677ed2=['toDataURL','backgroundColor','rgb(255,\x2084,\x20178)','imageSmoothingEnabled','clearAllPixels','9240245soilhp','Ready!','rgb(25,\x2025,\x20115)','pixels','coordsInput','uid','remove','6514420nhfpzG','rgb(0,\x200,\x200)','Enter\x201\x20to\x20sign\x20in,\x20or\x202\x20to\x20create\x20a\x20new\x20account:','touchmove','sqrt','#FFFFFF','addPixelBtn','rgb(136,\x20136,\x20136)','fillRect','email','rgb(154,\x200,\x200)','reloadTimer','input','deltaY','Log\x20In','Только\x20админ!','preventDefault','teleportBtn','Email:','style','shiftKey','display','left','width','rgb(255,\x20248,\x20137)','rgb(255,\x20101,\x20101)','mousemove','users/','banUser','catch','Come\x20in!','min','colorsChoice','fillStyle','max','top','ref','add','split','rgb(196,\x20196,\x20196)','img','trim','touches','logo100153@gmail.com','rgb(245,\x20223,\x20176)','game','Введите\x20корректные\x20координаты\x20X\x20Y','mousedown','1:461991610382:web:2a5ae293dde4a754c2d45f','none','\x20sec','error','adminPanel','data','classList','ctrlKey','getElementById','touchstart','selected','value','Log\x20Out','X:\x20','stroke','rgb(244,\x20179,\x20174)','currentUser','isNaN','now','grid','Добавлено','src','removePixelBtn','Password:','clientY','setTransform','rgb(255,\x20167,\x20209)','rgb(229,\x20217,\x200)','rgb(228,\x20228,\x20228)','moveTo','drawImage','1908640jmptTn','set','Login\x20to\x20draw!','contextmenu','touchend','naturalWidth','rgb(254,\x20164,\x2096)','Reload:\x20','addEventListener','click','4324456YWxGtW','6qVxKbQ','AIzaSyCwy4jVn9JIwXuIXVycYAv9EdPGPkgIJvA','4793340gksdOX','innerText','world.png','togglePalette','rgba(255,0,0,0.5)','clearRect','mouseup','Введите\x20UserID\x20для\x20бана:','\x20\x20Y:\x20','270795JuZJNk','clear','wheel','strokeStyle','pixellox.firebaseapp.com','color','length','getBoundingClientRect','altKey','461991610382','rgb(160,\x20106,\x2066)','teleportInput','floor','then','rgb(0,\x200,\x20234)','appendChild','forEach','height','rgb(96,\x2064,\x2040)','rgb(104,\x20131,\x2056)','clientX','3241518cKEeGf','rgb(0,\x20131,\x20199)','rgb(0,\x20211,\x20221)','button','ceil','complete','rgb(130,\x200,\x20128)','textContent','paletteToggle','push','lineTo'];_0x130c=function(){return _0x677ed2;};return _0x130c();}worldMap['src']=_0x1aed46(0x14e);const SCALE_TILE=0x28;let WORLD_W=0x4e20*SCALE_TILE,WORLD_H=0x4e20*SCALE_TILE,camX=0x0,camY=0x0,scale=0x1;const MIN_SCALE=0.005,MAX_SCALE=0x6;let isPanning=![],lastMouseX=0x0,lastMouseY=0x0;function clamp(_0x54d945,_0x165c50,_0x538ed8){const _0x2f55a9=_0x1aed46;return Math[_0x2f55a9(0x1a3)](_0x165c50,Math[_0x2f55a9(0x1a0)](_0x538ed8,_0x54d945));}function screenToWorld(_0x2e1aa9,_0x38fd14){const _0x4cd7a3=_0x1aed46,_0x312686=game[_0x4cd7a3(0x15c)](),_0x2be3c1=(_0x2e1aa9-_0x312686['left'])/scale+camX,_0x16adbe=(_0x38fd14-_0x312686['top'])/scale+camY;return[_0x2be3c1,_0x16adbe];}function snapToGrid(_0x529568,_0x236c78){const _0x53683e=_0x1aed46;return[Math[_0x53683e(0x161)](_0x529568/gridCellSize)*gridCellSize,Math[_0x53683e(0x161)](_0x236c78/gridCellSize)*gridCellSize];}let hoverCellX=0x0,hoverCellY=0x0;const pixelsCache=new Map();function _0x57a1(_0x3e6ffd,_0x4a4c1c){const _0x130cfb=_0x130c();return _0x57a1=function(_0x57a1ae,_0x9d35e1){_0x57a1ae=_0x57a1ae-0x122;let _0x5c2552=_0x130cfb[_0x57a1ae];return _0x5c2552;},_0x57a1(_0x3e6ffd,_0x4a4c1c);}let markers=[];function updateCoordsDisplay(){const _0x3cf1e2=_0x1aed46;if(!coordsDisplayEl)return;const _0x162d85=Math[_0x3cf1e2(0x161)](hoverCellX/gridCellSize),_0x10eaeb=Math[_0x3cf1e2(0x161)](hoverCellY/gridCellSize);coordsDisplayEl[_0x3cf1e2(0x171)]=_0x3cf1e2(0x12d)+_0x162d85+_0x3cf1e2(0x154)+_0x10eaeb;}const TILE_SIZE=0x3e8;let tiles=[];const offscreenCanvas=document['createElement']('canvas');offscreenCanvas[_0x1aed46(0x198)]=TILE_SIZE,offscreenCanvas[_0x1aed46(0x166)]=TILE_SIZE;const offCtx=offscreenCanvas['getContext']('2d',{'willReadFrequently':!![]});offCtx[_0x1aed46(0x178)]=![],worldMap['onload']=()=>{const _0x8d6cbd=_0x1aed46,_0x95fe6f=worldMap[_0x8d6cbd(0x144)]||0x4e20,_0x457039=worldMap['naturalHeight']||0x4e20;WORLD_W=_0x95fe6f*SCALE_TILE,WORLD_H=_0x457039*SCALE_TILE;const _0x2815ef=Math['ceil'](_0x95fe6f/TILE_SIZE),_0x3c0c58=Math[_0x8d6cbd(0x16e)](_0x457039/TILE_SIZE);tiles=[];for(let _0x4f99d3=0x0;_0x4f99d3<_0x2815ef;_0x4f99d3++){for(let _0x254a0f=0x0;_0x254a0f<_0x3c0c58;_0x254a0f++){const _0x670b9f=_0x4f99d3*TILE_SIZE,_0x168ddb=_0x254a0f*TILE_SIZE,_0x26c0bb=Math[_0x8d6cbd(0x1a0)](TILE_SIZE,_0x95fe6f-_0x670b9f),_0x19e7e3=Math['min'](TILE_SIZE,_0x457039-_0x168ddb);offCtx[_0x8d6cbd(0x151)](0x0,0x0,TILE_SIZE,TILE_SIZE),offCtx[_0x8d6cbd(0x13e)](worldMap,_0x670b9f,_0x168ddb,_0x26c0bb,_0x19e7e3,0x0,0x0,_0x26c0bb,_0x19e7e3);const _0x44ed7c=new Image();_0x44ed7c[_0x8d6cbd(0x135)]=offscreenCanvas[_0x8d6cbd(0x175)]('image/png');const _0x59dd97=_0x670b9f*SCALE_TILE,_0x48ff20=_0x168ddb*SCALE_TILE,_0x57b5e9=_0x26c0bb*SCALE_TILE,_0x5d44fc=_0x19e7e3*SCALE_TILE;tiles[_0x8d6cbd(0x173)]({'img':_0x44ed7c,'dx':_0x59dd97,'dy':_0x48ff20,'dw':_0x57b5e9,'dh':_0x5d44fc});}}renderAll();};function renderAll(){const _0x254832=_0x1aed46;ctx[_0x254832(0x178)]=![],ctx[_0x254832(0x139)](0x1,0x0,0x0,0x1,0x0,0x0),ctx[_0x254832(0x151)](0x0,0x0,game['width'],game[_0x254832(0x166)]),ctx[_0x254832(0x139)](scale,0x0,0x0,scale,-camX*scale,-camY*scale);const _0x406609=camX,_0x3e7918=camY,_0x3c53ce=camX+game[_0x254832(0x198)]/scale,_0x135c07=camY+game['height']/scale;for(const _0x53554c of tiles){if(_0x53554c['dx']+_0x53554c['dw']<_0x406609||_0x53554c['dx']>_0x3c53ce||_0x53554c['dy']+_0x53554c['dh']<_0x3e7918||_0x53554c['dy']>_0x135c07)continue;_0x53554c[_0x254832(0x1a9)][_0x254832(0x16f)]&&_0x53554c['img']['naturalWidth']?ctx['drawImage'](_0x53554c[_0x254832(0x1a9)],_0x53554c['dx'],_0x53554c['dy'],_0x53554c['dw'],_0x53554c['dh']):(ctx['fillStyle']='#eef6ff',ctx[_0x254832(0x189)](_0x53554c['dx'],_0x53554c['dy'],_0x53554c['dw'],_0x53554c['dh']));}ctx['beginPath'](),ctx[_0x254832(0x158)]='#ccc';let _0x3ddd88=Math[_0x254832(0x161)](_0x406609/gridCellSize)*gridCellSize;for(let _0x447f1a=_0x3ddd88;_0x447f1a<=_0x3c53ce;_0x447f1a+=gridCellSize){ctx[_0x254832(0x13d)](_0x447f1a,_0x3e7918),ctx[_0x254832(0x174)](_0x447f1a,_0x135c07);}let _0x2717de=Math[_0x254832(0x161)](_0x3e7918/gridCellSize)*gridCellSize;for(let _0x22a4cb=_0x2717de;_0x22a4cb<=_0x135c07;_0x22a4cb+=gridCellSize){ctx[_0x254832(0x13d)](_0x406609,_0x22a4cb),ctx[_0x254832(0x174)](_0x3c53ce,_0x22a4cb);}ctx[_0x254832(0x12e)](),pixelsCache[_0x254832(0x165)](_0x44a7e5=>{const _0x158fcc=_0x254832;_0x44a7e5['color']!==_0x158fcc(0x186)&&(ctx['fillStyle']=_0x44a7e5[_0x158fcc(0x15a)],ctx[_0x158fcc(0x189)](_0x44a7e5['x'],_0x44a7e5['y'],gridCellSize,gridCellSize));}),ctx[_0x254832(0x1a2)]=_0x254832(0x150);for(const [_0x5f5371,_0x29a507]of markers){ctx['fillRect'](_0x5f5371,_0x29a507,gridCellSize,gridCellSize);}ctx[_0x254832(0x1a2)]='rgba(0,0,0,0.12)',ctx[_0x254832(0x189)](hoverCellX,hoverCellY,gridCellSize,gridCellSize),ctx['setTransform'](0x1,0x0,0x0,0x1,0x0,0x0);}onSnapshot(collection(db,_0x1aed46(0x17d)),_0x46006f=>{const _0x1edf91=_0x1aed46;pixelsCache[_0x1edf91(0x156)](),_0x46006f['forEach'](_0x3f8f9b=>{const _0x2e5878=_0x1edf91,_0x43910d=_0x3f8f9b[_0x2e5878(0x125)]();pixelsCache[_0x2e5878(0x140)](_0x43910d['x']+'-'+_0x43910d['y'],_0x43910d);}),renderAll();}),game[_0x1aed46(0x147)](_0x1aed46(0x1b0),_0x5ae88e=>{const _0x78a5e5=_0x1aed46;(_0x5ae88e[_0x78a5e5(0x16d)]===0x1||_0x5ae88e[_0x78a5e5(0x16d)]===0x2||_0x5ae88e[_0x78a5e5(0x195)]||_0x5ae88e[_0x78a5e5(0x127)]||_0x5ae88e['metaKey']||_0x5ae88e[_0x78a5e5(0x15d)])&&(isPanning=!![],lastMouseX=_0x5ae88e[_0x78a5e5(0x169)],lastMouseY=_0x5ae88e['clientY'],_0x5ae88e['preventDefault']());}),window[_0x1aed46(0x147)](_0x1aed46(0x152),()=>{isPanning=![];}),game['addEventListener'](_0x1aed46(0x142),_0x5812d8=>_0x5812d8['preventDefault']()),game['addEventListener'](_0x1aed46(0x19b),_0x3e6c74=>{const _0x2e75e8=_0x1aed46;if(isPanning){const _0x3df3e7=_0x3e6c74[_0x2e75e8(0x169)]-lastMouseX,_0x50aa01=_0x3e6c74['clientY']-lastMouseY;camX-=_0x3df3e7/scale,camY-=_0x50aa01/scale,lastMouseX=_0x3e6c74[_0x2e75e8(0x169)],lastMouseY=_0x3e6c74[_0x2e75e8(0x138)],renderAll();}const [_0x323c56,_0x219cfd]=screenToWorld(_0x3e6c74['clientX'],_0x3e6c74['clientY']);[hoverCellX,hoverCellY]=snapToGrid(_0x323c56,_0x219cfd),updateCoordsDisplay(),renderAll();}),game['addEventListener'](_0x1aed46(0x157),_0xe92b1e=>{const _0x4968c5=_0x1aed46;_0xe92b1e['preventDefault']();const _0xf18eea=1.1,[_0x2644d2,_0xcf3122]=screenToWorld(_0xe92b1e[_0x4968c5(0x169)],_0xe92b1e[_0x4968c5(0x138)]),_0x2ae0cc=_0xe92b1e[_0x4968c5(0x18e)]<0x0?0x1:-0x1,_0x5cb5d6=clamp(scale*(_0x2ae0cc>0x0?_0xf18eea:0x1/_0xf18eea),MIN_SCALE,MAX_SCALE);if(_0x5cb5d6===scale)return;scale=_0x5cb5d6;const _0x3636d6=game['getBoundingClientRect']();camX=_0x2644d2-(_0xe92b1e['clientX']-_0x3636d6[_0x4968c5(0x197)])/scale,camY=_0xcf3122-(_0xe92b1e[_0x4968c5(0x138)]-_0x3636d6[_0x4968c5(0x1a4)])/scale;const [_0x4fa951,_0xc4cf26]=screenToWorld(_0xe92b1e['clientX'],_0xe92b1e[_0x4968c5(0x138)]);[hoverCellX,hoverCellY]=snapToGrid(_0x4fa951,_0xc4cf26),updateCoordsDisplay(),renderAll();},{'passive':![]});async function placePixelWithHover(){const _0x48213f=_0x1aed46;if(!auth[_0x48213f(0x130)])return alert(_0x48213f(0x141));if(!canPlace)return;canPlace=![];const _0x2b6310=hoverCellX,_0x24dcaa=hoverCellY,_0x1b1f37=doc(db,_0x48213f(0x17d),_0x2b6310+'-'+_0x24dcaa);try{if(currentColor===_0x48213f(0x186))await deleteDoc(_0x1b1f37);else await setDoc(_0x1b1f37,{'x':_0x2b6310,'y':_0x24dcaa,'color':currentColor});}catch(_0x45e951){console[_0x48213f(0x123)](_0x45e951);}startReload();}game['addEventListener']('click',_0x469443=>{const _0x322f91=_0x1aed46;if(isPanning||_0x469443[_0x322f91(0x16d)]!==0x0)return;placePixelWithHover();});if(cursor)cursor[_0x1aed46(0x194)][_0x1aed46(0x196)]=_0x1aed46(0x1b2);function startReload(){const _0x3feb64=_0x1aed46;let _0xe89182=reloadTime;reloadTimerEl[_0x3feb64(0x14d)]=_0x3feb64(0x146)+_0xe89182+_0x3feb64(0x122);const _0x3bb859=setInterval(()=>{const _0x102d73=_0x3feb64;_0xe89182--;if(_0xe89182<=0x0)clearInterval(_0x3bb859),canPlace=!![],reloadTimerEl[_0x102d73(0x14d)]=_0x102d73(0x17b);else reloadTimerEl[_0x102d73(0x14d)]=_0x102d73(0x146)+_0xe89182+_0x102d73(0x122);},0x3e8);}authButton[_0x1aed46(0x147)](_0x1aed46(0x148),async()=>{const _0x327969=_0x1aed46;if(auth['currentUser']){await signOut(auth);return;}const _0x5bc02b=prompt(_0x327969(0x183));if(!_0x5bc02b||_0x5bc02b!=='1'&&_0x5bc02b!=='2')return;const _0x24d248=prompt(_0x327969(0x193)),_0x3e7980=prompt(_0x327969(0x137));if(!_0x24d248||!_0x3e7980)return;try{_0x5bc02b==='1'?(await signInWithEmailAndPassword(auth,_0x24d248,_0x3e7980),alert(_0x327969(0x19f))):(await createUserWithEmailAndPassword(auth,_0x24d248,_0x3e7980),alert('Account\x20created!'));}catch(_0x19976c){alert(_0x19976c['message']);}}),onAuthStateChanged(auth,_0x2aaa22=>{const _0x3d44fa=_0x1aed46;_0x2aaa22?(authButton[_0x3d44fa(0x171)]=_0x3d44fa(0x12c),_0x2aaa22['email']==='logo100153@gmail.com'?adminPanel['style'][_0x3d44fa(0x196)]='block':adminPanel['style']['display']=_0x3d44fa(0x1b2)):(authButton['textContent']=_0x3d44fa(0x18f),adminPanel['style'][_0x3d44fa(0x196)]=_0x3d44fa(0x1b2));});function parseCoords(){const _0x418e14=_0x1aed46;markers=[];const _0x4e25b6=coordsInput[_0x418e14(0x12b)][_0x418e14(0x1aa)]();if(!_0x4e25b6){renderAll();return;}_0x4e25b6[_0x418e14(0x1a7)](',')[_0x418e14(0x165)](_0x15d41d=>{const _0x1221b7=_0x418e14,[_0x4ab0db,_0x4df22f,_0x420cda,_0x471332]=_0x15d41d['trim']()['split'](/\s+/),_0x53c754=parseInt(_0x4ab0db),_0x17e96a=parseInt(_0x4df22f),_0xec8923=parseInt(_0x420cda||'1'),_0x5dbb37=parseInt(_0x471332||'1');if(Number[_0x1221b7(0x131)](_0x53c754)||Number['isNaN'](_0x17e96a)||Number[_0x1221b7(0x131)](_0xec8923)||Number[_0x1221b7(0x131)](_0x5dbb37))return;const _0x55c81d=_0x53c754*gridCellSize,_0x41ec7b=_0x17e96a*gridCellSize;for(let _0x153a2e=0x0;_0x153a2e<_0xec8923;_0x153a2e++){for(let _0x7c1a4f=0x0;_0x7c1a4f<_0x5dbb37;_0x7c1a4f++){const _0x431f43=_0x55c81d+_0x153a2e*gridCellSize,_0x4ec001=_0x41ec7b+_0x7c1a4f*gridCellSize;_0x431f43>=0x0&&_0x4ec001>=0x0&&_0x431f43<=WORLD_W-gridCellSize&&_0x4ec001<=WORLD_H-gridCellSize&&markers[_0x1221b7(0x173)]([_0x431f43,_0x4ec001]);}}}),renderAll();}coordsInput[_0x1aed46(0x147)](_0x1aed46(0x18d),parseCoords);async function adminApplyPixels(_0x3ba0ea){const _0x5256f4=_0x1aed46;if(!auth[_0x5256f4(0x130)]||auth[_0x5256f4(0x130)]['email']!==_0x5256f4(0x1ac))return alert('Только\x20админ!');parseCoords();let _0x47d6aa=0x0;for(const [_0x2671bb,_0x5da03d]of markers){const _0x30c867=doc(db,_0x5256f4(0x17d),_0x2671bb+'-'+_0x5da03d);_0x3ba0ea===_0x5256f4(0x1a6)?(await setDoc(_0x30c867,{'x':_0x2671bb,'y':_0x5da03d,'color':currentColor}),_0x47d6aa++):(await deleteDoc(_0x30c867),_0x47d6aa++);}alert((_0x3ba0ea==='add'?_0x5256f4(0x134):'Удалено')+'\x20пикселей:\x20'+_0x47d6aa);}addPixelBtn[_0x1aed46(0x147)](_0x1aed46(0x148),()=>adminApplyPixels(_0x1aed46(0x1a6))),removePixelBtn['addEventListener'](_0x1aed46(0x148),()=>adminApplyPixels(_0x1aed46(0x180))),clearAllPixelsBtn['addEventListener'](_0x1aed46(0x148),async()=>{const _0x331a1a=_0x1aed46;if(!auth[_0x331a1a(0x130)])return alert('Только\x20админ!');const _0xa3a5f9=await getDocs(collection(db,'pixels'));_0xa3a5f9['forEach'](_0x243e6f=>deleteDoc(_0x243e6f[_0x331a1a(0x1a5)]));}),banUserBtn[_0x1aed46(0x147)](_0x1aed46(0x148),()=>{const _0x525353=_0x1aed46;if(!auth[_0x525353(0x130)])return alert(_0x525353(0x190));const _0x44eb5c=prompt(_0x525353(0x153));if(!_0x44eb5c)return;const _0x42ce29=ref(rtdb,_0x525353(0x19c)+_0x44eb5c);remove(_0x42ce29)[_0x525353(0x162)](()=>alert('Пользователь\x20забанен!'))[_0x525353(0x19e)](_0x48591d=>console[_0x525353(0x123)](_0x48591d));});import{onDisconnect,set}from'https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js';function trackOnlinePlayer(){const _0x47020b=_0x1aed46;if(!auth['currentUser'])return;const _0x59b120=auth[_0x47020b(0x130)][_0x47020b(0x17f)],_0x1e40d8=ref(rtdb,'users/'+_0x59b120);set(_0x1e40d8,{'email':auth[_0x47020b(0x130)][_0x47020b(0x18a)],'lastSeen':Date[_0x47020b(0x132)]()}),onDisconnect(_0x1e40d8)[_0x47020b(0x180)]();}onAuthStateChanged(auth,_0x174358=>{_0x174358&&trackOnlinePlayer();});function updateOnlinePlayers(){const _0x18ff36=_0x1aed46,_0x5106fc=ref(rtdb,_0x18ff36(0x19c));onValue(_0x5106fc,_0x236b82=>{const _0x131869=_0x18ff36,_0x1ec746=_0x236b82['val'](),_0x490734=_0x1ec746?Object['keys'](_0x1ec746)['length']:0x0;onlinePlayersEl[_0x131869(0x14d)]='Online\x20players:\x20'+_0x490734;});}updateOnlinePlayers();let lastTouchX=0x0,lastTouchY=0x0,isTouchPanning=![],lastTouchDist=0x0;function getTouchDist(_0x479c60){const _0x15a89b=_0x1aed46;if(_0x479c60[_0x15a89b(0x15b)]<0x2)return 0x0;const _0x2e1b5b=_0x479c60[0x0][_0x15a89b(0x169)]-_0x479c60[0x1][_0x15a89b(0x169)],_0x415362=_0x479c60[0x0][_0x15a89b(0x138)]-_0x479c60[0x1]['clientY'];return Math[_0x15a89b(0x185)](_0x2e1b5b*_0x2e1b5b+_0x415362*_0x415362);}game[_0x1aed46(0x147)](_0x1aed46(0x129),_0x3441d8=>{const _0x51a30a=_0x1aed46;_0x3441d8['preventDefault']();if(_0x3441d8[_0x51a30a(0x1ab)][_0x51a30a(0x15b)]===0x1)isTouchPanning=!![],lastTouchX=_0x3441d8[_0x51a30a(0x1ab)][0x0][_0x51a30a(0x169)],lastTouchY=_0x3441d8['touches'][0x0][_0x51a30a(0x138)];else _0x3441d8['touches'][_0x51a30a(0x15b)]===0x2&&(lastTouchDist=getTouchDist(_0x3441d8[_0x51a30a(0x1ab)]));},{'passive':![]}),game[_0x1aed46(0x147)](_0x1aed46(0x184),_0x5a30bd=>{const _0x55a00d=_0x1aed46;_0x5a30bd[_0x55a00d(0x191)]();if(_0x5a30bd[_0x55a00d(0x1ab)]['length']===0x1&&isTouchPanning){const _0xd5ae55=_0x5a30bd[_0x55a00d(0x1ab)][0x0][_0x55a00d(0x169)]-lastTouchX,_0x5930c2=_0x5a30bd[_0x55a00d(0x1ab)][0x0][_0x55a00d(0x138)]-lastTouchY;camX-=_0xd5ae55/scale,camY-=_0x5930c2/scale,lastTouchX=_0x5a30bd[_0x55a00d(0x1ab)][0x0]['clientX'],lastTouchY=_0x5a30bd['touches'][0x0]['clientY'];const [_0x2447f3,_0x51d2fa]=screenToWorld(lastTouchX,lastTouchY);[hoverCellX,hoverCellY]=snapToGrid(_0x2447f3,_0x51d2fa),updateCoordsDisplay(),renderAll();}else{if(_0x5a30bd['touches'][_0x55a00d(0x15b)]===0x2){const _0x30532c=getTouchDist(_0x5a30bd[_0x55a00d(0x1ab)]);if(lastTouchDist>0x0){const _0x1ade70=_0x30532c/lastTouchDist,_0x1cf720=(_0x5a30bd['touches'][0x0]['clientX']+_0x5a30bd[_0x55a00d(0x1ab)][0x1]['clientX'])/0x2,_0x139b64=(_0x5a30bd[_0x55a00d(0x1ab)][0x0]['clientY']+_0x5a30bd[_0x55a00d(0x1ab)][0x1][_0x55a00d(0x138)])/0x2,[_0x51fc20,_0x228456]=screenToWorld(_0x1cf720,_0x139b64);scale=clamp(scale*_0x1ade70,MIN_SCALE,MAX_SCALE);const _0x43ea73=game[_0x55a00d(0x15c)]();camX=_0x51fc20-(_0x1cf720-_0x43ea73[_0x55a00d(0x197)])/scale,camY=_0x228456-(_0x139b64-_0x43ea73[_0x55a00d(0x1a4)])/scale;const [_0x183787,_0x433b0c]=screenToWorld(_0x1cf720,_0x139b64);[hoverCellX,hoverCellY]=snapToGrid(_0x183787,_0x433b0c),updateCoordsDisplay(),renderAll();}lastTouchDist=_0x30532c;}}},{'passive':![]}),game['addEventListener'](_0x1aed46(0x143),_0x1019a7=>{const _0x3875d0=_0x1aed46;if(_0x1019a7[_0x3875d0(0x1ab)][_0x3875d0(0x15b)]===0x0)isTouchPanning=![];}),game[_0x1aed46(0x147)](_0x1aed46(0x143),_0x19cb9b=>{const _0x51a15e=_0x1aed46;_0x19cb9b[_0x51a15e(0x1ab)]['length']===0x0&&!isTouchPanning&&placePixelWithHover();});
